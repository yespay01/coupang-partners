# 쿠팡 링크 체계 정리

> 최종 업데이트: 2026-02-23

## 링크 종류

| 종류 | 형태 | 설명 |
|------|------|------|
| 일반 URL | `www.coupang.com/vp/products/123` | 제휴 파라미터 없는 순수 URL |
| 제휴 링크 | `www.coupang.com/vp/products/123?affiliateCode=...&subId=...` | 쿠팡 파트너스 API 수집 시 자동 포함 |
| 딥링크 (단축) | `link.coupang.com/...` | 일반 URL을 제휴 단축 URL로 변환한 결과 |

## 상품 수집 시 링크 흐름

1. 쿠팡 파트너스 API로 상품을 검색하면 `productUrl`에 이미 **제휴 파라미터(affiliateCode, subId)**가 포함됨
2. 따라서 수집된 상품의 `productUrl`은 **제휴 링크**임
3. 별도의 딥링크 변환 없이 `productUrl`을 그대로 제휴 링크로 사용

## 딥링크 API는 언제 사용하나?

딥링크 API(`/v2/.../deeplink`)는 **일반 쿠팡 URL을 제휴 단축 URL로 변환**할 때만 사용:

- 사용자가 직접 쿠팡에서 복사한 URL을 제휴 링크로 만들고 싶을 때
- 블로그/SNS에 공유할 짧은 제휴 링크가 필요할 때

**주의:** 이미 제휴 파라미터가 붙은 URL(`affiliateCode=...`)을 딥링크 API에 넣으면 인식하지 못함. 반드시 **순수 쿠팡 URL**을 입력해야 함.

## 코드에서의 규칙

- 상품 수집(`searchProducts`) 결과의 `productUrl` → 이미 제휴 링크이므로 딥링크 변환 불필요
- 관리자 딥링크 도구(`/admin/deeplink`) → 일반 URL을 입력받아 딥링크 API로 변환
- DB 저장 시: `product_url` = 제휴 링크, `affiliate_url` = 딥링크(단축) 또는 제휴 링크
