# ì¿ íŒ¡ ìë™ ë¸”ë¡œê·¸ ì„œë²„ ë°°í¬ ê°€ì´ë“œ

## ğŸ“‹ ë°°í¬ ê°œìš”

- **ë„ë©”ì¸**: semolink.store
- **ì„œë²„**: Ubuntu 20.04
- **ë°°í¬ ê²½ë¡œ**: `/home/insuk/blog`
- **í¬íŠ¸**: 3000 (ë‚´ë¶€), 443 (HTTPS)
- **SSL**: Let's Encrypt (ì´ë¯¸ ì„¤ì •ë¨)

---

## ğŸš€ ë°°í¬ ë‹¨ê³„

### 1ë‹¨ê³„: í”„ë¡œì íŠ¸ íŒŒì¼ ì„œë²„ë¡œ ì „ì†¡

ë¡œì»¬ì—ì„œ ë‹¤ìŒ íŒŒì¼ë“¤ì„ ì„œë²„ë¡œ ì „ì†¡í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ì „ì†¡í•  ë””ë ‰í† ë¦¬/íŒŒì¼:
web/
â”œâ”€â”€ app/
â”œâ”€â”€ components/
â”œâ”€â”€ hooks/
â”œâ”€â”€ stores/
â”œâ”€â”€ types/
â”œâ”€â”€ public/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ .env.production
â”œâ”€â”€ next.config.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ nginx-semolink.conf
```

**ì „ì†¡ ë°©ë²• (ì˜ˆì‹œ):**
- FTP/SFTP í´ë¼ì´ì–¸íŠ¸ (FileZilla, WinSCP ë“±)
- Git clone í›„ ì„œë²„ì—ì„œ pull
- rsync ì‚¬ìš©

---

### 2ë‹¨ê³„: ì„œë²„ ì¸¡ ì‘ì—… (ì„œë²„ Claudeê°€ ì‹¤í–‰)

#### 2-1. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„±

```bash
# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /home/insuk/blog
cd /home/insuk/blog

# ê¶Œí•œ í™•ì¸
ls -la
```

#### 2-2. Firebase Admin SDK í‚¤ ì„¤ì •

`.env.production` íŒŒì¼ì—ì„œ Firebase Admin SDK ì •ë³´ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´:

```bash
# .env.production í¸ì§‘
nano .env.production

# ë‹¤ìŒ í•­ëª© ìˆ˜ì •:
# - FIREBASE_ADMIN_CLIENT_EMAIL
# - FIREBASE_ADMIN_PRIVATE_KEY
```

**Firebase Admin SDK í‚¤ ìƒì„± ë°©ë²•:**
1. Firebase Console (https://console.firebase.google.com)
2. í”„ë¡œì íŠ¸ ì„¤ì • > ì„œë¹„ìŠ¤ ê³„ì •
3. "ìƒˆ ë¹„ê³µê°œ í‚¤ ìƒì„±" í´ë¦­
4. ë‹¤ìš´ë¡œë“œëœ JSON íŒŒì¼ì—ì„œ ê°’ ë³µì‚¬

#### 2-3. Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì‹¤í–‰

```bash
# Docker Composeë¡œ ë¹Œë“œ ë° ì‹¤í–‰
docker-compose up -d --build

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps
```

#### 2-4. ì»¨í…Œì´ë„ˆ ë™ì‘ í™•ì¸

```bash
# í—¬ìŠ¤ì²´í¬
curl http://127.0.0.1:3000

# ë¡œê·¸ í™•ì¸
docker logs coupang-blog

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì† (í•„ìš”ì‹œ)
docker exec -it coupang-blog sh
```

#### 2-5. Nginx ì„¤ì • ì—…ë°ì´íŠ¸

```bash
# Nginx ì„¤ì • íŒŒì¼ ë³µì‚¬
sudo cp nginx-semolink.conf /etc/nginx/sites-available/semolink-blog

# ê¸°ì¡´ ì„¤ì • ë°±ì—… (ì„ íƒì‚¬í•­)
sudo cp /etc/nginx/sites-available/semolink-blog /etc/nginx/sites-available/semolink-blog.backup

# ì‹¬ë³¼ë¦­ ë§í¬ ìƒì„± (ì´ë¯¸ ìˆìœ¼ë©´ ìŠ¤í‚µ)
sudo ln -sf /etc/nginx/sites-available/semolink-blog /etc/nginx/sites-enabled/

# Nginx ì„¤ì • í…ŒìŠ¤íŠ¸
sudo nginx -t

# Nginx ì¬ì‹œì‘
sudo systemctl reload nginx
```

---

## âœ… ë°°í¬ í™•ì¸

### 1. ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸
```
https://semolink.store
```

### 2. SSL ì¸ì¦ì„œ í™•ì¸
```bash
curl -I https://semolink.store
```

### 3. ë¡œê·¸ í™•ì¸
```bash
# Docker ë¡œê·¸
docker logs coupang-blog

# Nginx ë¡œê·¸
sudo tail -f /var/log/nginx/semolink-blog-access.log
sudo tail -f /var/log/nginx/semolink-blog-error.log
```

---

## ğŸ”„ ì—…ë°ì´íŠ¸ ë°©ë²•

ì½”ë“œ ë³€ê²½ í›„ ì¬ë°°í¬:

```bash
cd /home/insuk/blog

# ë³€ê²½ëœ ì½”ë“œ ê°€ì ¸ì˜¤ê¸° (git ì‚¬ìš© ì‹œ)
git pull

# ë˜ëŠ” ìƒˆ íŒŒì¼ ì—…ë¡œë“œ í›„

# ì»¨í…Œì´ë„ˆ ì¬ë¹Œë“œ ë° ì¬ì‹œì‘
docker-compose down
docker-compose up -d --build

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

---

## ğŸ›‘ ì„œë¹„ìŠ¤ ì¤‘ì§€

```bash
cd /home/insuk/blog
docker-compose down
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•Šì„ ë•Œ
```bash
# ë¡œê·¸ í™•ì¸
docker logs coupang-blog

# í™˜ê²½ë³€ìˆ˜ í™•ì¸
docker exec coupang-blog env
```

### Nginx 502 Bad Gateway
```bash
# Next.js ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps
curl http://127.0.0.1:3000

# Nginx ì„¤ì • í™•ì¸
sudo nginx -t
```

### SSL ì¸ì¦ì„œ ë¬¸ì œ
```bash
# ì¸ì¦ì„œ ê°±ì‹ 
sudo certbot renew

# Nginx ì¬ì‹œì‘
sudo systemctl reload nginx
```

---

## ğŸ“ ì£¼ìš” ëª…ë ¹ì–´ ìš”ì•½

```bash
# ì‹œì‘
docker-compose up -d

# ì¤‘ì§€
docker-compose down

# ì¬ì‹œì‘
docker-compose restart

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# ì¬ë¹Œë“œ
docker-compose up -d --build
```

---

## ğŸ” ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `.env.production`ì— ì‹¤ì œ Firebase Admin SDK í‚¤ ì„¤ì •
- [ ] `ADMIN_GUARD_BYPASS=false` ì„¤ì • (í”„ë¡œë•ì…˜)
- [ ] SSL ì¸ì¦ì„œ ìë™ ê°±ì‹  í™•ì¸ (`certbot renew`)
- [ ] ë°©í™”ë²½ ì„¤ì • (í¬íŠ¸ 80, 443ë§Œ ì—´ê¸°)
- [ ] Docker ì»¨í…Œì´ë„ˆê°€ 127.0.0.1:3000ì—ë§Œ ë°”ì¸ë”©ë˜ì—ˆëŠ”ì§€ í™•ì¸

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. âœ… ë¡œì»¬ì—ì„œ `web/` ë””ë ‰í† ë¦¬ ì„œë²„ë¡œ ì „ì†¡
2. âœ… ì„œë²„ì—ì„œ ìœ„ ëª…ë ¹ì–´ë“¤ ì‹¤í–‰
3. âœ… https://semolink.store ì ‘ì† í™•ì¸
4. âœ… ê´€ë¦¬ì í˜ì´ì§€ ë™ì‘ í™•ì¸ (`/admin`)
5. âœ… Firebase FunctionsëŠ” Firebaseì—ì„œ ê³„ì† ì‹¤í–‰ (ë³„ë„ ë°°í¬ í•„ìš” ì—†ìŒ)
