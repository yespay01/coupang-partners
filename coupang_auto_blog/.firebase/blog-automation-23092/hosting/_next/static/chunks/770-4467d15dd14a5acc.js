"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{4770:(e,t,s)=>{s.d(t,{D:()=>eG});var l=s(5155),a=s(2115),r=s(63),n=s(2498),i=s(6436);let o=[{label:"이번주 커미션",value:"₩184,500",trend:"+12% WoW"},{label:"클릭 → 주문 전환율",value:"3.4%",trend:"+0.6pp"},{label:"금일 클릭 수",value:"1,248",trend:"-4% QoQ"}],c=[{id:"fallback-1",productId:"prod_fallback_1",product:"샤오미 무선 청소기 G11",author:"auto-bot-4",status:"needs_revision",updatedAt:"2024-07-14T08:42:00+09:00",createdAt:"2024-07-14T08:00:00+09:00",toneScore:.42,charCount:128,content:"먼지통 청소와 배터리 관리 팁을 추가하면 더 완성도 있는 리뷰가 될 것 같습니다."},{id:"fallback-2",productId:"prod_fallback_2",product:"삼성 비스포크 냉장고 700L",author:"auto-bot-2",status:"draft",updatedAt:"2024-07-14T08:10:00+09:00",createdAt:"2024-07-14T07:30:00+09:00",toneScore:.58,charCount:142,content:"용량 대비 전력 효율을 강조했고, 내부 수납 구성에 대한 한줄 요약까지 준비되어 있습니다."},{id:"fallback-3",productId:"prod_fallback_3",product:"필립스 에어프라이어 5.5L",author:"manager-jy",status:"approved",updatedAt:"2024-07-14T07:55:00+09:00",createdAt:"2024-07-14T07:10:00+09:00",toneScore:.76,charCount:151,content:"에어프라이어 기본 온도 세팅과 예열 팁을 담아 초보자도 이해하기 쉽게 정리했습니다."},{id:"fallback-4",productId:"prod_fallback_4",product:"로지텍 MX Keys S",author:"manager-hs",status:"published",updatedAt:"2024-07-14T07:10:00+09:00",createdAt:"2024-07-14T06:40:00+09:00",toneScore:.83,charCount:137,content:"스위치 감도와 백라이트 반응 속도를 비교해주어 구매 전 고민 포인트를 해소해줍니다."}],d=[{level:"info",message:"review_retry_queue 작업 처리 완료",createdAt:"2024-07-14 07:58",context:"productId=prod_7831, attempt=2"},{level:"warn",message:"톤 점수 0.38 → 재생성 큐 등록",createdAt:"2024-07-14 07:47",context:"productId=prod_5421"},{level:"error",message:"Slack Webhook 응답 지연으로 재시도",createdAt:"2024-07-14 07:40",context:"retryAttempt=1"}],x=["draft","needs_revision","approved","published"],u=["info","warn","error"];function m(e){var t,s,l,a;return{id:e.id,level:null!=(t=e.level)?t:"info",message:null!=(s=e.message)?s:"",createdAt:null!=(l=e.createdAt)?l:"",context:null!=(a=e.context)?a:""}}let h={"24h":864e5,"7d":6048e5,"30d":2592e6};function p(e){return"all"===e?null:new Date(Date.now()-h[e])}function b(e,t){return e?t.filter(t=>{var s;return null!=(s=e[t])&&s}):[...t]}function g(e,t){return t.map(t=>"".concat(t,":").concat(+(null!=e&&!!e[t]))).join("|")}var f=s(5959),v=s(9863);let j={draft:!0,needs_revision:!0,approved:!0,published:!0},w={info:!0,warn:!0,error:!0},N=(0,f.v)((0,v.Zr)(e=>({reviewStatuses:j,reviewLimitFilter:12,reviewSearch:"",reviewDateFilter:"all",selectedReviewId:null,logLevels:w,logSearch:"",logDateFilter:"all",reviewPageIndex:0,logPageIndex:0,setReviewStatus:(t,s)=>e(e=>({reviewStatuses:{...e.reviewStatuses,[t]:s}})),setReviewStatuses:t=>e(()=>({reviewStatuses:t})),setReviewLimitFilter:t=>e(()=>({reviewLimitFilter:t})),setReviewSearch:t=>e(()=>({reviewSearch:t})),setReviewDateFilter:t=>e(()=>({reviewDateFilter:t})),setSelectedReview:t=>e(()=>({selectedReviewId:t})),setLogLevel:(t,s)=>e(e=>({logLevels:{...e.logLevels,[t]:s}})),setLogLevels:t=>e(()=>({logLevels:t})),setLogSearch:t=>e(()=>({logSearch:t})),setLogDateFilter:t=>e(()=>({logDateFilter:t})),setReviewPageIndex:t=>e(()=>({reviewPageIndex:t})),setLogPageIndex:t=>e(()=>({logPageIndex:t}))}),{name:"admin-dashboard-store",partialize:e=>({reviewStatuses:e.reviewStatuses,reviewLimitFilter:e.reviewLimitFilter,reviewSearch:e.reviewSearch,reviewDateFilter:e.reviewDateFilter,selectedReviewId:e.selectedReviewId,logLevels:e.logLevels,logSearch:e.logSearch,logDateFilter:e.logDateFilter,reviewPageIndex:e.reviewPageIndex,logPageIndex:e.logPageIndex})}));var y=s(2454),k=s(9776),C=s(549);let L={all:["reviews"],lists:()=>[...L.all,"list"],list:e=>[...L.lists(),e],details:()=>[...L.all,"detail"],detail:e=>[...L.details(),e]};var M=s(8134),S=s(8789);async function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reviews",{app:s}=await (0,S.w)(),l=(0,M.c7)(s),a=Date.now(),r=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),n="".concat(t,"/").concat(a,"_").concat(r),i=(0,M.KR)(l,n),o=await (0,M.D)(i,e);return{url:await (0,M.qk)(o.ref),path:n,name:e.name,type:e.type,size:e.size}}async function D(e){let{app:t}=await (0,S.w)(),s=(0,M.c7)(t),l=(0,M.KR)(s,e);await (0,M.XR)(l)}var T=s(154),I=s(699),F=s(3660),H=s(6135),R=s(4036),K=s(7004),W=s(9148),P=s(3419),E=s(5699),B=s(8336),_=s(2984),z=s(9371);let O=E.XI.extend({addAttributes(){var e;return{...null==(e=this.parent)?void 0:e.call(this),style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}},border:{default:null,parseHTML:e=>e.getAttribute("border"),renderHTML:e=>e.border?{border:e.border}:{}},cellpadding:{default:null,parseHTML:e=>e.getAttribute("cellpadding"),renderHTML:e=>e.cellpadding?{cellpadding:e.cellpadding}:{}},cellspacing:{default:null,parseHTML:e=>e.getAttribute("cellspacing"),renderHTML:e=>e.cellspacing?{cellspacing:e.cellspacing}:{}},width:{default:null,parseHTML:e=>e.getAttribute("width"),renderHTML:e=>e.width?{width:e.width}:{}}}}}),q=B.H.extend({addAttributes(){var e;return{...null==(e=this.parent)?void 0:e.call(this),style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}}}}}),G=_.n.extend({addAttributes(){var e;return{...null==(e=this.parent)?void 0:e.call(this),style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}},width:{default:null,parseHTML:e=>e.getAttribute("width"),renderHTML:e=>e.width?{width:e.width}:{}},colspan:{default:null,parseHTML:e=>e.getAttribute("colspan"),renderHTML:e=>e.colspan?{colspan:e.colspan}:{}},rowspan:{default:null,parseHTML:e=>e.getAttribute("rowspan"),renderHTML:e=>e.rowspan?{rowspan:e.rowspan}:{}},valign:{default:null,parseHTML:e=>e.getAttribute("valign"),renderHTML:e=>e.valign?{valign:e.valign}:{}},align:{default:null,parseHTML:e=>e.getAttribute("align"),renderHTML:e=>e.align?{align:e.align}:{}},bgcolor:{default:null,parseHTML:e=>e.getAttribute("bgcolor"),renderHTML:e=>e.bgcolor?{bgcolor:e.bgcolor}:{}}}}}),V=z.A.extend({addAttributes(){var e;return{...null==(e=this.parent)?void 0:e.call(this),style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}},width:{default:null,parseHTML:e=>e.getAttribute("width"),renderHTML:e=>e.width?{width:e.width}:{}},colspan:{default:null,parseHTML:e=>e.getAttribute("colspan"),renderHTML:e=>e.colspan?{colspan:e.colspan}:{}},rowspan:{default:null,parseHTML:e=>e.getAttribute("rowspan"),renderHTML:e=>e.rowspan?{rowspan:e.rowspan}:{}}}}});function U(e){let{onClick:t,isActive:s=!1,disabled:a=!1,title:r,children:n}=e;return(0,l.jsx)("button",{type:"button",onClick:t,disabled:a,title:r,className:"p-2 rounded-lg transition ".concat(s?"bg-slate-900 text-white":"text-slate-600 hover:bg-slate-100"," ").concat(a?"opacity-50 cursor-not-allowed":""),children:n})}function Y(){return(0,l.jsx)("div",{className:"w-px h-6 bg-slate-200 mx-1"})}function Q(e){let{editor:t,onImageUpload:s,isHtmlMode:r,onToggleHtmlMode:n}=e,i=(0,a.useCallback)(()=>{if(!t)return;let e=window.prompt("YouTube URL을 입력하세요:");e&&t.commands.setYoutubeVideo({src:e})},[t]),o=(0,a.useCallback)(()=>{if(!t)return;let e=t.getAttributes("link").href,s=window.prompt("링크 URL을 입력하세요:",e);if(null!==s){if(""===s)return void t.chain().focus().extendMarkRange("link").unsetLink().run();t.chain().focus().extendMarkRange("link").setLink({href:s}).run()}},[t]),c=(0,a.useCallback)(()=>{if(!t)return;let e=window.prompt("이미지 URL을 입력하세요:");e&&t.chain().focus().setImage({src:e}).run()},[t]);return t||r?(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-slate-200 bg-slate-50 rounded-t-xl",children:[!r&&t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleBold().run(),isActive:t.isActive("bold"),title:"굵게 (Ctrl+B)",children:(0,l.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z"})]})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleItalic().run(),isActive:t.isActive("italic"),title:"기울임 (Ctrl+I)",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 4h4m-2 0l-4 16m0 0h4"})})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleUnderline().run(),isActive:t.isActive("underline"),title:"밑줄 (Ctrl+U)",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v7a5 5 0 0010 0V4M5 20h14"})})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleStrike().run(),isActive:t.isActive("strike"),title:"취소선",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v4m0 4v8M4 12h16"})})}),(0,l.jsx)(Y,{}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:t.isActive("heading",{level:1}),title:"제목 1 (H1)",children:(0,l.jsx)("span",{className:"text-sm font-bold",children:"H1"})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:t.isActive("heading",{level:2}),title:"제목 2 (H2)",children:(0,l.jsx)("span",{className:"text-sm font-bold",children:"H2"})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),isActive:t.isActive("heading",{level:3}),title:"제목 3 (H3)",children:(0,l.jsx)("span",{className:"text-sm font-bold",children:"H3"})}),(0,l.jsx)(Y,{}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleBulletList().run(),isActive:t.isActive("bulletList"),title:"글머리 기호",children:(0,l.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"}),(0,l.jsx)("circle",{cx:"2",cy:"6",r:"1",fill:"currentColor"}),(0,l.jsx)("circle",{cx:"2",cy:"12",r:"1",fill:"currentColor"}),(0,l.jsx)("circle",{cx:"2",cy:"18",r:"1",fill:"currentColor"})]})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleOrderedList().run(),isActive:t.isActive("orderedList"),title:"번호 매기기",children:(0,l.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 6h13M7 12h13M7 18h13"}),(0,l.jsx)("text",{x:"1",y:"8",fontSize:"6",fill:"currentColor",children:"1"}),(0,l.jsx)("text",{x:"1",y:"14",fontSize:"6",fill:"currentColor",children:"2"}),(0,l.jsx)("text",{x:"1",y:"20",fontSize:"6",fill:"currentColor",children:"3"})]})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().toggleBlockquote().run(),isActive:t.isActive("blockquote"),title:"인용구",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-4l-4 4z"})})}),(0,l.jsx)(Y,{}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().setTextAlign("left").run(),isActive:t.isActive({textAlign:"left"}),title:"왼쪽 정렬",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h10M4 18h14"})})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().setTextAlign("center").run(),isActive:t.isActive({textAlign:"center"}),title:"가운데 정렬",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M7 12h10M5 18h14"})})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().setTextAlign("right").run(),isActive:t.isActive({textAlign:"right"}),title:"오른쪽 정렬",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M10 12h10M6 18h14"})})}),(0,l.jsx)(Y,{}),(0,l.jsx)(U,{onClick:o,isActive:t.isActive("link"),title:"링크 추가",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),s&&(0,l.jsx)(U,{onClick:s,title:"이미지 업로드",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,l.jsx)(U,{onClick:c,title:"이미지 URL",children:(0,l.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"})]})}),(0,l.jsx)(U,{onClick:i,title:"YouTube 영상",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})}),(0,l.jsx)(Y,{}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().undo().run(),disabled:!t.can().undo(),title:"실행 취소 (Ctrl+Z)",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),(0,l.jsx)(U,{onClick:()=>t.chain().focus().redo().run(),disabled:!t.can().redo(),title:"다시 실행 (Ctrl+Y)",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10H11a8 8 0 00-8 8v2m18-10l-6 6m6-6l-6-6"})})}),(0,l.jsx)(Y,{})]}),r&&(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-medium text-amber-700 bg-amber-100 rounded",children:"HTML 소스 편집 모드"}),(0,l.jsx)(U,{onClick:n,isActive:r,title:r?"에디터 보기":"HTML 소스 보기",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})})]}):null}function Z(e){let{content:t,onChange:s,placeholder:r="내용을 입력하세요...",onImageUpload:n}=e,[i,o]=(0,a.useState)(()=>(function(e){if(!e)return!1;let t=/<table[\s>]/i.test(e),s=(e.match(/style\s*=/gi)||[]).length,l=(e.match(/<table[\s>]/gi)||[]).length;return t&&(s>5||l>1)})(t)),[c,d]=(0,a.useState)(t),x=(0,a.useRef)(!1),u=(0,a.useRef)(!1),m=(0,T.hG)({immediatelyRender:!1,extensions:[I.A.configure({heading:{levels:[1,2,3]}}),P.A,F.Ay.configure({HTMLAttributes:{class:"rounded-lg max-w-full h-auto my-4"}}),H.Ay.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}}),R.A.configure({width:640,height:360,HTMLAttributes:{class:"rounded-lg my-4 mx-auto"}}),K.A.configure({placeholder:r}),W.A.configure({types:["heading","paragraph"]}),O.configure({resizable:!1}),q,V,G],content:i?"":t||"",editorProps:{attributes:{class:"prose prose-slate max-w-none min-h-[300px] p-4 focus:outline-none"}},onUpdate:e=>{let{editor:t}=e;x.current=!0,s(t.getHTML())},onCreate:e=>{let{editor:s}=e;if(i){u.current=!0;return}if(t&&!u.current)try{s.commands.setContent(t),u.current=!0}catch(e){console.error("초기 콘텐츠 설정 중 오류:",e),o(!0)}}});(0,a.useEffect)(()=>{if(!m||i)return;if(x.current){x.current=!1;return}let e=m.getHTML();if(t&&("<p></p>"===e||""===e||t!==e))try{m.commands.setContent(t)}catch(e){console.error("콘텐츠 업데이트 중 오류:",e),o(!0),d(t)}},[t,m,i]);let h=(0,a.useCallback)(e=>{m&&m.chain().focus().setImage({src:e}).run()},[m]);(0,a.useEffect)(()=>(window.insertEditorImage=h,()=>{delete window.insertEditorImage}),[h]),(0,a.useEffect)(()=>{d(t)},[t]);let p=(0,a.useCallback)(()=>{if(i){if(m)try{m.commands.setContent(c),s(c),o(!1)}catch(e){console.error("HTML을 에디터에 적용하는 중 오류 발생:",e),alert("이 HTML은 WYSIWYG 에디터에서 지원하지 않는 형식입니다. HTML 소스 모드에서 편집해주세요.")}}else m&&d(m.getHTML()),o(!0)},[i,c,m,s]),b=(0,a.useCallback)(e=>{let t=e.target.value;d(t),s(t)},[s]);return(0,l.jsxs)("div",{className:"border border-slate-200 rounded-xl overflow-hidden bg-white",children:[(0,l.jsx)(Q,{editor:m,onImageUpload:n,isHtmlMode:i,onToggleHtmlMode:p}),i?(0,l.jsx)("textarea",{value:c,onChange:b,className:"w-full min-h-[300px] p-4 font-mono text-sm text-slate-800 bg-slate-50 focus:outline-none resize-none",placeholder:"HTML 코드를 입력하세요..."}):(0,l.jsx)(T.$Z,{editor:m})]})}let X=[{value:"",label:"카테고리 선택"},{value:"lifestyle",label:"라이프스타일"},{value:"digital",label:"디지털/가전"},{value:"kitchen",label:"주방/쿠킹"},{value:"fashion",label:"패션/뷰티"},{value:"food",label:"식품"},{value:"baby",label:"유아/아동"},{value:"sports",label:"스포츠/레저"},{value:"etc",label:"기타"}],J=[{value:"draft",label:"초안"},{value:"needs_revision",label:"재검수 필요"},{value:"approved",label:"승인 완료"},{value:"published",label:"게시 완료"}];function $(e){let{isOpen:t,onClose:s,reviewId:r,onSaved:o}=e,[c,d]=(0,a.useState)(""),[x,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[p,b]=(0,a.useState)(""),[g,f]=(0,a.useState)("draft"),[v,j]=(0,a.useState)([]),[w,N]=(0,a.useState)(!1),[M,S]=(0,a.useState)(null),[T,I]=(0,a.useState)(null),[F,H]=(0,a.useState)(0),R=(0,a.useRef)(null),K=!!r,{data:W,isLoading:P,error:E}=function(e){let{status:t}=(0,n.D)();return(0,y.I)({queryKey:L.detail(null!=e?e:""),queryFn:async()=>e?(0,i.RV)(e):null,enabled:!!e&&"ready"===t,staleTime:6e4})}(t?r:null),B=function(){let e=(0,k.jE)();return(0,C.n)({mutationFn:async e=>await (0,i.bx)(e),onSuccess:()=>{e.invalidateQueries({queryKey:L.lists()})}})}(),_=function(){let e=(0,k.jE)();return(0,C.n)({mutationFn:async e=>{let{reviewId:t,input:s}=e;return await (0,i.Gm)(t,s),t},onSuccess:t=>{e.invalidateQueries({queryKey:L.lists()}),e.invalidateQueries({queryKey:L.detail(t)})}})}(),z=B.isPending||_.isPending;(0,a.useEffect)(()=>{if(t){if(!r){d(""),u(""),h(""),b(""),f("draft"),j([]),H(e=>e+1);return}if(W){var e,s,l,a,n,i;d(null!=(e=W.productName)?e:""),u(null!=(s=W.content)?s:""),h(null!=(l=W.category)?l:""),b(null!=(a=W.affiliateUrl)?a:""),f(null!=(n=W.status)?n:"draft"),j(null!=(i=W.media)?i:[]),H(e=>e+1)}}},[t,r,W]),(0,a.useEffect)(()=>{E&&S("리뷰를 불러오는 중 오류가 발생했습니다.")},[E]);let O=(0,a.useCallback)(async e=>{if(!e||0===e.length)return;N(!0),S(null);let t=[];for(let s=0;s<e.length;s++){let l=e[s];if(I("업로드 중... (".concat(s+1,"/").concat(e.length,")")),!["image/jpeg","image/png","image/gif","image/webp","video/mp4","video/webm","video/quicktime"].includes(l.type)){S("지원하지 않는 파일 형식입니다: ".concat(l.name));continue}if(!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.size<=1024*t*1024}(l,50)){S("파일 크기가 50MB를 초과합니다: ".concat(l.name));continue}try{let e=await A(l,"reviews"),s={url:e.url,path:e.path,name:e.name,type:l.type.startsWith("video/")?"video":"image",size:e.size};if(t.push(s),"image"===s.type){let t=window.insertEditorImage;t&&t(e.url)}}catch(e){console.error("파일 업로드 실패:",e),S("파일 업로드 실패: ".concat(l.name))}}t.length>0&&j(e=>[...e,...t]),N(!1),I(null),R.current&&(R.current.value="")},[]),q=(0,a.useCallback)(async e=>{let t=v[e];if(t){try{await D(t.path)}catch(e){console.warn("Storage 파일 삭제 실패:",e)}j(t=>t.filter((t,s)=>s!==e))}},[v]),G=(0,a.useCallback)(e=>{{let t=window.insertEditorImage;t&&"image"===e.type&&t(e.url)}},[]),V=(0,a.useCallback)(async()=>{if(!c.trim())return void S("상품명을 입력해주세요.");if(!x.trim()||"<p></p>"===x)return void S("리뷰 내용을 입력해주세요.");S(null);let e={productName:c.trim(),content:x.trim(),category:m,affiliateUrl:p.trim(),status:g,media:v};try{r?await _.mutateAsync({reviewId:r,input:e}):await B.mutateAsync(e),null==o||o(),s()}catch(e){console.error("저장 실패:",e),S("저장 중 오류가 발생했습니다.")}},[c,x,m,p,g,v,r,B,_,o,s]),U=(0,a.useCallback)(e=>{e.preventDefault(),O(e.dataTransfer.files)},[O]),Y=(0,a.useCallback)(e=>{e.preventDefault()},[]),Q=(0,a.useCallback)(()=>{var e;null==(e=R.current)||e.click()},[]);return t?(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),(0,l.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:K?"리뷰 수정":"새 리뷰 작성"}),(0,l.jsx)("button",{type:"button",onClick:s,className:"p-2 rounded-full hover:bg-slate-100 transition",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:P?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-900"})}):(0,l.jsxs)("div",{className:"space-y-6",children:[M&&(0,l.jsx)("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-700",children:M}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["상품명 ",(0,l.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"상품 이름을 입력하세요",className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"카테고리"}),(0,l.jsx)("select",{value:m,onChange:e=>h(e.target.value),className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-slate-900 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200",children:X.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"상태"}),(0,l.jsx)("select",{value:g,onChange:e=>f(e.target.value),className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-slate-900 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200",children:J.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"쿠팡 파트너스 링크"}),(0,l.jsx)("input",{type:"url",value:p,onChange:e=>b(e.target.value),placeholder:"https://link.coupang.com/...",className:"w-full rounded-xl border border-slate-200 px-4 py-3 text-slate-900 placeholder:text-slate-400 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"})]}),(0,l.jsx)("input",{ref:R,type:"file",accept:"image/*,video/*",multiple:!0,onChange:e=>O(e.target.files),className:"hidden"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["리뷰 내용 ",(0,l.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,l.jsx)(Z,{content:x,onChange:u,placeholder:"상품에 대한 리뷰를 작성하세요...",onImageUpload:Q},F),(0,l.jsxs)("p",{className:"mt-2 text-xs text-slate-500",children:["글자 수: ",x.replace(/<[^>]*>/g,"").length,"자 | 툴바에서 제목, 굵게, 이미지, 링크 등을 추가할 수 있습니다"]})]}),w&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-600"}),T]}),v.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["업로드된 미디어 (",v.length,"개)"]}),(0,l.jsxs)("div",{onDrop:U,onDragOver:Y,className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-3 rounded-xl border-2 border-dashed border-slate-200 bg-slate-50/50",children:[v.map((e,t)=>(0,l.jsxs)("div",{className:"relative group rounded-xl overflow-hidden border border-slate-200 bg-white",children:["image"===e.type?(0,l.jsx)("img",{src:e.url,alt:e.name,className:"w-full h-24 object-cover"}):(0,l.jsx)("div",{className:"w-full h-24 flex items-center justify-center bg-slate-100",children:(0,l.jsxs)("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),(0,l.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition flex items-center justify-center gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>G(e),className:"p-1.5 rounded-full bg-white text-slate-700 hover:bg-slate-100",title:"본문에 삽입",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,l.jsx)("button",{type:"button",onClick:()=>q(t),className:"p-1.5 rounded-full bg-white text-rose-600 hover:bg-rose-50",title:"삭제",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),(0,l.jsxs)("p",{className:"px-2 py-1 text-xs text-slate-500 truncate",children:[e.name," (",function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(e.size),")"]})]},e.path)),(0,l.jsxs)("label",{className:"flex flex-col items-center justify-center h-24 rounded-xl border-2 border-dashed border-slate-200 bg-white cursor-pointer hover:border-slate-300 hover:bg-slate-50 transition",children:[(0,l.jsx)("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:e=>O(e.target.files),className:"hidden"}),(0,l.jsx)("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,l.jsx)("span",{className:"mt-1 text-xs text-slate-400",children:"추가"})]})]})]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200 bg-slate-50",children:[(0,l.jsx)("button",{type:"button",onClick:s,className:"px-5 py-2.5 rounded-xl border border-slate-200 text-sm font-semibold text-slate-700 hover:bg-white transition",children:"취소"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[K&&(0,l.jsxs)("span",{className:"text-xs text-slate-500",children:["수정 중인 리뷰: ",null==r?void 0:r.slice(0,8),"..."]}),(0,l.jsx)("button",{type:"button",onClick:V,disabled:z||w,className:"px-6 py-2.5 rounded-xl bg-slate-900 text-sm font-semibold text-white hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:z?"저장 중...":K?"수정 완료":"리뷰 등록"})]})]})]})]}):null}var ee=s(3820);function et(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t).concat(s).concat(l)}function es(e){let t=new Map;return e.forEach(e=>{t.has(e.date)||t.set(e.date,e)}),Array.from(t.values())}async function el(e){let t=await fetch("/api/coupang/reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("리포트 조회 실패");let s=await t.json();if(!s.success)throw Error(s.message||"리포트 조회 실패");return s.data}function ea(){var e,t,s,l;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{settings:r}=(0,ee.C)(),{coupang:n}=r,i=et(new Date),o=et(function(e){let t=new Date;return t.setDate(t.getDate()-e),t}(a)),c=n.enabled&&!!n.accessKey&&!!n.secretKey,d=(0,y.I)({queryKey:["coupang-reports","clicks",o,i],queryFn:()=>el({accessKey:n.accessKey,secretKey:n.secretKey,reportType:"clicks",startDate:o,endDate:i}),enabled:c,staleTime:9e5,gcTime:36e5,retry:1}),x=(0,y.I)({queryKey:["coupang-reports","orders",o,i],queryFn:()=>el({accessKey:n.accessKey,secretKey:n.secretKey,reportType:"orders",startDate:o,endDate:i}),enabled:c,staleTime:9e5,gcTime:36e5,retry:1}),u=(0,y.I)({queryKey:["coupang-reports","cancels",o,i],queryFn:()=>el({accessKey:n.accessKey,secretKey:n.secretKey,reportType:"cancels",startDate:o,endDate:i}),enabled:c,staleTime:9e5,gcTime:36e5,retry:1}),m=(0,y.I)({queryKey:["coupang-reports","commission",o,i],queryFn:()=>el({accessKey:n.accessKey,secretKey:n.secretKey,reportType:"commission",startDate:o,endDate:i}),enabled:c,staleTime:9e5,gcTime:36e5,retry:1}),h=m.data&&u.data?{totalClicks:es(m.data).reduce((e,t)=>{var s;return e+(null!=(s=t.clicks)?s:0)},0),totalOrders:es(m.data).reduce((e,t)=>{var s;return e+(null!=(s=t.orders)?s:0)},0),totalGmv:es(m.data).reduce((e,t)=>{var s;return e+(null!=(s=t.gmv)?s:0)},0),totalCommission:es(m.data).reduce((e,t)=>{var s;return e+(null!=(s=t.commission)?s:0)},0),totalCancels:es(u.data).reduce((e,t)=>{var s;return e+(null!=(s=t.cancelCnt)?s:0)},0),period:{startDate:o,endDate:i}}:null,p=d.isLoading||x.isLoading||u.isLoading||m.isLoading,b=d.error||x.error||u.error||m.error;return{clicks:es(null!=(e=d.data)?e:[]),orders:es(null!=(t=x.data)?t:[]),cancels:es(null!=(s=u.data)?s:[]),commission:es(null!=(l=m.data)?l:[]),summary:h,isEnabled:c,isLoading:p,error:b instanceof Error?b.message:b?"리포트 조회 실패":null,refetch:()=>{d.refetch(),x.refetch(),u.refetch(),m.refetch()}}}function er(e){return"".concat(e.toFixed(1),"%")}function en(){let e=new Date,t=e.getDay(),s=new Date(e);s.setDate(e.getDate()+(0===t?-6:1-t)),s.setHours(0,0,0,0);let l=new Date(s);return l.setDate(s.getDate()+6),l.setHours(23,59,59,999),{start:s,end:l}}function ei(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t).concat(s).concat(l)}let eo={draft:"bg-sky-100 text-sky-700 border-sky-200",needs_revision:"bg-amber-100 text-amber-700 border-amber-200",approved:"bg-emerald-100 text-emerald-700 border-emerald-200",published:"bg-slate-100 text-slate-700 border-slate-200"},ec={draft:"초안",needs_revision:"재검수 필요",approved:"승인 완료",published:"게시 완료"},ed=["draft","needs_revision","approved","published"],ex={info:"border-sky-200 bg-sky-50 text-sky-800",warn:"border-amber-200 bg-amber-50 text-amber-800",error:"border-rose-200 bg-rose-50 text-rose-800"},eu=["info","warn","error"],em={draft:[{label:"승인",nextStatus:"approved",tone:"primary"},{label:"재검수 요청",nextStatus:"needs_revision",tone:"secondary"}],needs_revision:[{label:"재승인",nextStatus:"approved",tone:"primary"},{label:"임시 저장",nextStatus:"draft",tone:"secondary"}],approved:[{label:"게시",nextStatus:"published",tone:"primary"},{label:"재검수 요청",nextStatus:"needs_revision",tone:"secondary"}],published:[{label:"승인 단계로 되돌리기",nextStatus:"approved",tone:"secondary"}]},eh={primary:"bg-slate-900 text-white hover:bg-slate-800",secondary:"border border-slate-200 text-slate-700 hover:bg-slate-100",danger:"border border-rose-200 text-rose-600 hover:bg-rose-50"},ep=[{value:"all",label:"전체"},{value:"24h",label:"24시간"},{value:"7d",label:"7일"},{value:"30d",label:"30일"}],eb={"24h":864e5,"7d":6048e5,"30d":2592e6},eg={overview:{title:"쿠팡 파트너스 자동화 대시보드",description:"수집–생성–검수–발행까지 이어지는 AI 리뷰 파이프라인과 로그를 한 화면에서 점검하세요."},reviews:{title:"리뷰 승인 워크플로우",description:"상태, 검색, 기간 필터로 AI 리뷰 초안을 검토하고 단건/일괄 승인 흐름을 관리합니다."},logs:{title:"자동화 로그 탐색",description:"Cloud Functions, Firestore Trigger, Slack 알림 로그를 검색\xb7필터링하며 안정성을 모니터링합니다."}},ef=[{time:"02:00",title:"상품 자동 수집",description:"쿠팡 API에서 신규 상품 메타 데이터를 가져옵니다."},{time:"02:10",title:"AI 후기 생성",description:"OpenAI를 호출해 초안을 만들고 품질 규칙을 통과한 것만 저장합니다."},{time:"09:10",title:"승인 즉시 게시",description:"관리자 승인이 떨어지면 ISR 페이지와 sitemap을 자동 갱신합니다."},{time:"18:00",title:"수익 통계 갱신",description:"클릭/주문 데이터를 Firestore에 집계하고 로그로 추적합니다."}],ev=[{icon:"\uD83D\uDD04",label:"자동 수집 & 재시도 큐",description:"상품 수집 실패 시 자동으로 재시도합니다."},{icon:"\uD83E\uDD16",label:"OpenAI 품질 규칙",description:"톤 점수, 글자 수 검증을 통과한 리뷰만 저장됩니다."},{icon:"\uD83D\uDCCA",label:"수익 대시보드",description:"클릭, 주문, 커미션을 실시간으로 추적합니다."},{icon:"\uD83D\uDD14",label:"Slack 알림",description:"오류 발생 시 즉시 Slack으로 알림을 받습니다."}];function ej(e){if(!e)return"-";let t=new Date(e);return Number.isNaN(t.getTime())?e:new Intl.DateTimeFormat("ko-KR",{dateStyle:"medium",timeStyle:"short"}).format(t)}function ew(e){let{reviews:t,selectedReviewId:s,selectedReviewIds:r,isInteractive:n,pendingReviewId:i,onRowSelect:o,onToggleSelection:c,onSelectAll:d,onStatusChange:x,onEditReview:u}=e,m=(0,a.useRef)(null),h=t.filter(e=>!!e.id),p=h.length>0&&h.every(e=>e.id&&r.includes(e.id)),b=r.length>0&&!p;(0,a.useEffect)(()=>{m.current&&(m.current.indeterminate=b)},[b]);let g=(0,a.useCallback)(e=>{o(e)},[o]);return(0,l.jsx)("div",{className:"overflow-hidden rounded-2xl border border-slate-100",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm text-slate-700",children:[(0,l.jsx)("thead",{className:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3",children:(0,l.jsx)("input",{ref:m,type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-500",checked:p,onChange:e=>d(e.target.checked)})}),(0,l.jsx)("th",{className:"px-4 py-3",children:"상품"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"작성자"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"상태"}),(0,l.jsx)("th",{className:"px-4 py-3",children:"업데이트"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right",children:"조치"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-slate-100 bg-white",children:[t.map(e=>{var t,a;return(0,l.jsxs)("tr",{className:"cursor-pointer transition hover:bg-slate-50/60 ".concat(s===e.id?"bg-slate-100/80":""),onClick:()=>g(e),children:[(0,l.jsx)("td",{className:"px-4 py-3",children:e.id?(0,l.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-500",checked:r.includes(e.id),onChange:t=>c(e.id,t.target.checked),onClick:e=>e.stopPropagation()}):(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"-"})}),(0,l.jsx)("td",{className:"px-4 py-3 font-medium text-slate-900",children:e.product}),(0,l.jsx)("td",{className:"px-4 py-3 text-sm text-slate-600",children:e.author}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsx)("span",{className:"inline-flex rounded-full border px-3 py-1 text-xs font-semibold ".concat(eo[e.status]),children:null!=(t=ec[e.status])?t:e.status})}),(0,l.jsx)("td",{className:"px-4 py-3 text-xs text-slate-500",children:ej(e.updatedAt)}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex flex-wrap justify-end gap-2",children:[e.id&&(0,l.jsx)("button",{type:"button",className:"rounded-full border border-blue-200 px-3 py-1 text-xs font-semibold text-blue-600 transition hover:bg-blue-50",onClick:t=>{t.stopPropagation(),u(e.id)},children:"편집"}),em[e.status].map(t=>{let s=!n||i===e.id||!e.id;return(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 text-xs font-semibold transition ".concat(eh[t.tone]," ").concat(s?"cursor-not-allowed opacity-50":""),disabled:s,onClick:s=>{s.stopPropagation(),x(e.id,e.product,t.nextStatus)},children:i===e.id?"처리 중…":t.label},"".concat(e.product,"-").concat(t.nextStatus))})]})})]},null!=(a=e.id)?a:"".concat(e.product,"-").concat(e.updatedAt))}),0===t.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-4 py-6 text-center text-xs text-slate-500",children:"선택된 필터에 해당하는 리뷰가 없습니다."})})]})]})})}function eN(e){var t,s,a,r;let{review:n}=e;return n?(0,l.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-5",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"선택한 리뷰 상세"}),(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:["상품 ID: ",(0,l.jsx)("span",{className:"font-mono text-slate-700",children:null!=(t=n.productId)?t:"-"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[(0,l.jsx)("span",{children:"톤 점수"}),(0,l.jsx)("span",{className:"rounded-full bg-white px-3 py-1 font-semibold text-slate-900",children:null!=(s=n.toneScore)?s:"-"}),(0,l.jsx)("span",{children:"글자 수"}),(0,l.jsx)("span",{className:"rounded-full bg-white px-3 py-1 font-semibold text-slate-900",children:null!=(a=n.charCount)?a:"-"})]})]}),(0,l.jsx)("div",{className:"rounded-2xl bg-white p-4 text-sm text-slate-700 shadow-sm review-content max-w-none overflow-auto",dangerouslySetInnerHTML:{__html:null!=(r=n.content)?r:"<p>리뷰 본문이 없습니다.</p>"}}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[(0,l.jsxs)("span",{children:["생성: ",n.createdAt?ej(n.createdAt):"-"]}),(0,l.jsxs)("span",{children:["최근 업데이트: ",n.updatedAt?ej(n.updatedAt):"-"]})]})]})}):(0,l.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-5",children:(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"테이블에서 행을 선택하면 리뷰 본문과 메타 정보를 확인할 수 있습니다."})})}function ey(e){let{logs:t}=e;return 0===t.length?(0,l.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50/60 px-4 py-6 text-center text-xs text-slate-500",children:"조건에 해당하는 로그가 없습니다. 필터를 조정하거나 검색어를 지워보세요."}):(0,l.jsx)("div",{className:"grid gap-3 lg:grid-cols-3",children:t.map(e=>(0,l.jsxs)("article",{className:"rounded-2xl border px-4 py-4 shadow-sm ".concat(ex[e.level]),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs font-semibold uppercase tracking-wide",children:[(0,l.jsx)("span",{children:e.level}),(0,l.jsx)("span",{className:"font-mono text-[11px] opacity-70",children:e.createdAt})]}),(0,l.jsx)("p",{className:"mt-2 text-sm font-semibold",children:e.message}),(0,l.jsx)("p",{className:"mt-1 text-xs opacity-80",children:e.context})]},"".concat(e.createdAt,"-").concat(e.message)))})}function ek(e){let{metrics:t}=e;return(0,l.jsx)("section",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(e=>{var t;return(0,l.jsxs)("article",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md",children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:e.label}),(0,l.jsx)("p",{className:"mt-3 text-3xl font-bold text-slate-900",children:e.value}),e.trend?(0,l.jsx)("p",{className:"mt-2 text-xs text-emerald-600",children:e.trend}):null]},null!=(t=e.label)?t:e.id)})})}function eC(){return(0,l.jsxs)("section",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"자동화 타임라인"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"일일 자동화 루틴 스케줄 (Asia/Seoul)"})]}),(0,l.jsx)("span",{className:"rounded-full bg-emerald-100 px-3 py-1 text-xs font-medium text-emerald-700",children:"활성화됨"})]}),(0,l.jsx)("ul",{className:"space-y-3",children:ef.map(e=>(0,l.jsxs)("li",{className:"rounded-xl border border-slate-100 bg-slate-50/50 p-4",children:[(0,l.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,l.jsx)("span",{className:"rounded-full bg-slate-900 px-2.5 py-1 text-xs font-mono font-semibold text-white",children:e.time}),(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.title})]}),(0,l.jsx)("p",{className:"mt-2 text-xs text-slate-600 pl-14",children:e.description})]},e.time))})]}),(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"시스템 기능"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"현재 활성화된 자동화 기능 목록"})]}),(0,l.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:ev.map(e=>(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-slate-50/50 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)("span",{className:"text-lg",children:e.icon}),(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.label})]}),(0,l.jsx)("p",{className:"text-xs text-slate-600",children:e.description})]},e.label))}),(0,l.jsxs)("div",{className:"mt-4 rounded-xl border border-dashed border-slate-200 bg-slate-50/30 p-4 text-center",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Firebase Console에서 Functions 상태와 Scheduler 로그를 확인하세요."}),(0,l.jsxs)("a",{href:"https://console.firebase.google.com/",target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-flex items-center gap-1 text-xs font-medium text-blue-600 hover:text-blue-700",children:["Firebase 콘솔 열기",(0,l.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})}var eL=s(7773);function eM(e){return"number"!=typeof e||isNaN(e)?"₩0":new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(e)}function eS(){var e,t;let[s,r]=(0,a.useState)(7),{isLoading:n}=(0,eL.e6)(),{commission:i,clicks:o,orders:c,summary:d,isEnabled:x,isLoading:u,error:m,refetch:h}=ea(s),p=(0,a.useMemo)(()=>{let e=[],t=new Date;for(let l=s-1;l>=0;l--){let s=new Date(t);s.setDate(t.getDate()-l);let a=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");e.push("".concat(a).concat(r).concat(n))}let l=new Map;i.forEach(e=>{l.set(e.date,e.commission)});let a=e.map(e=>{var t;return{date:e,dateLabel:function(e){if(!e||8!==e.length)return e;let t=e.slice(4,6),s=e.slice(6,8);return"".concat(t,"/").concat(s)}(e),value:null!=(t=l.get(e))?t:0}}),r=Math.max(...a.map(e=>e.value),1);return a.map(e=>({...e,percentage:e.value>0?e.value/r*100:0}))},[i,s]),b=(0,a.useMemo)(()=>{var e,t,s,l;let a=null!=(e=null==d?void 0:d.totalClicks)?e:0,r=null!=(t=null==d?void 0:d.totalCommission)?t:0;return{avgCommission:p.length>0?r/p.length:0,revenuePerClick:a>0?r/a:0,totalOrders:null!=(s=null==d?void 0:d.totalOrders)?s:0,totalGmv:null!=(l=null==d?void 0:d.totalGmv)?l:0}},[p.length,d]);return x?n||u?(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"수익 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"데이터를 불러오는 중..."})]})}),(0,l.jsx)("div",{className:"mt-6 h-40 animate-pulse rounded-2xl bg-slate-100"})]}):m?(0,l.jsx)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"수익 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-red-500",children:m})]}),(0,l.jsx)("button",{type:"button",onClick:()=>h(),className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-200",children:"다시 시도"})]})}):(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"수익 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"쿠팡 파트너스 실적 (매일 오후 15:00 업데이트)"})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:[7,14,30].map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>r(e),className:"rounded-full px-3 py-1 text-xs font-medium transition ".concat(s===e?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[e,"일"]},e))})]}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[p.length>0&&(0,l.jsxs)("div",{className:"flex h-48 flex-col justify-between py-2 text-xs text-slate-500",children:[(0,l.jsx)("div",{className:"text-right",children:eM(Math.max(...p.map(e=>e.value)))}),(0,l.jsx)("div",{className:"text-right",children:eM(Math.max(...p.map(e=>e.value))/2)}),(0,l.jsx)("div",{className:"text-right",children:"₩0"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"h-48 rounded-2xl border border-slate-200 bg-gradient-to-b from-slate-50 to-white p-4",children:p.length>0?(0,l.jsx)("div",{className:"flex h-full items-end justify-center gap-2",children:p.map(e=>(0,l.jsxs)("div",{className:"group relative flex h-full flex-col justify-end",style:{width:"".concat(100/p.length-2,"%"),maxWidth:"40px"},children:[(0,l.jsx)("div",{style:{height:e.percentage>0?"".concat(e.percentage,"%"):"0"},className:"w-full rounded-t-md bg-sky-500 transition-all group-hover:bg-sky-600"}),(0,l.jsxs)("div",{className:"absolute bottom-full left-1/2 mb-2 hidden -translate-x-1/2 whitespace-nowrap rounded-lg bg-slate-900 px-3 py-1.5 text-xs text-white shadow-lg group-hover:block",children:[(0,l.jsx)("div",{className:"font-medium",children:e.dateLabel}),(0,l.jsx)("div",{className:"text-sky-200",children:eM(e.value)})]})]},e.date))}):(0,l.jsx)("div",{className:"flex h-full items-center justify-center text-sm text-slate-400",children:"데이터가 없습니다"})}),p.length>0&&(0,l.jsx)("div",{className:"mt-2 flex justify-center gap-2 text-[10px] text-slate-500",children:p.map((e,t)=>{let a=7===s||14===s&&t%2==0||30===s&&t%5==0;return(0,l.jsx)("div",{className:"text-center",style:{width:"".concat(100/p.length-2,"%"),maxWidth:"40px"},children:a?e.dateLabel:""},e.date)})})]})]}),(0,l.jsxs)("dl",{className:"mt-6 grid grid-cols-2 gap-4 text-xs text-slate-600 sm:grid-cols-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"총 수익"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:eM(null!=(e=null==d?void 0:d.totalCommission)?e:0)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"평균 수익/일"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:eM(b.avgCommission)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"총 클릭"}),(0,l.jsxs)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:[(null!=(t=null==d?void 0:d.totalClicks)?t:0).toLocaleString(),"회"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"클릭당 수익"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:eM(b.revenuePerClick)})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-between border-t border-slate-100 pt-4 text-xs text-slate-500",children:[(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("span",{children:["주문: ",(0,l.jsxs)("strong",{className:"text-slate-700",children:[b.totalOrders.toLocaleString(),"건"]})]}),(0,l.jsxs)("span",{children:["매출: ",(0,l.jsx)("strong",{className:"text-slate-700",children:eM(b.totalGmv)})]})]}),(0,l.jsx)("button",{type:"button",onClick:()=>h(),className:"font-medium text-blue-600 hover:underline",children:"새로고침"})]})]}):(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"수익 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"쿠팡 파트너스 API를 연동하면 실제 수익 데이터를 확인할 수 있습니다."})]})}),(0,l.jsx)("div",{className:"mt-6 flex h-40 items-center justify-center rounded-2xl bg-slate-50",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"쿠팡 API 연동 필요"}),(0,l.jsx)("a",{href:"/admin/settings",className:"mt-2 inline-block text-xs font-medium text-blue-600 hover:underline",children:"설정 페이지로 이동"})]})})]})}function eA(e){let{selectedCount:t,isPending:s,onBulkStatusChange:a,onClearSelection:r}=e,n=0===t||s;return(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[(0,l.jsxs)("p",{children:["선택된 리뷰: ",t,"건"]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:()=>a("approved"),disabled:n,children:"선택 승인"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:()=>a("needs_revision"),disabled:n,children:"재검수 요청"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:()=>a("published"),disabled:n,children:"선택 게시"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:r,disabled:n,children:"선택 해제"})]})]})}function eD(e){let{pageIndex:t,hasNext:s,hasPrev:a,onNext:r,onPrev:n}=e;return(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[(0,l.jsxs)("span",{children:["페이지 ",(0,l.jsx)("span",{className:"font-semibold text-slate-700",children:t+1})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:n,disabled:!a,children:"이전"}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 px-3 py-1 font-semibold text-slate-600 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-40",onClick:r,disabled:!s,children:"다음"})]})]})}function eT(e){return"number"!=typeof e||isNaN(e)?"₩0":new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(e)}function eI(e){return"number"!=typeof e||isNaN(e)?"0":e.toLocaleString()}function eF(){let[e,t]=(0,a.useState)(7),{isLoading:s}=(0,eL.e6)(),{clicks:r,orders:n,cancels:i,commission:o,summary:c,isEnabled:d,isLoading:x,error:u,refetch:m}=ea(e),h=(0,a.useMemo)(()=>{var e,t,s,l,a;if(!c)return{totalClicks:0,totalOrders:0,totalCancels:0,totalCommission:0,totalGmv:0,avgOrderValue:0,conversionRate:0,cancelRate:0};let r=null!=(e=c.totalClicks)?e:0,n=null!=(t=c.totalOrders)?t:0,i=null!=(s=c.totalCancels)?s:0,o=null!=(l=c.totalCommission)?l:0,d=null!=(a=c.totalGmv)?a:0;return{totalClicks:r,totalOrders:n,totalCancels:i,totalCommission:o,totalGmv:d,avgOrderValue:n>0?d/n:0,conversionRate:r>0?n/r*100:0,cancelRate:n>0?i/n*100:0}},[c]),p=(0,a.useMemo)(()=>[...r].sort((e,t)=>t.date.localeCompare(e.date)),[r]);return d?s||x?(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"실적 리포트"}),(0,l.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,l.jsx)("div",{className:"h-24 animate-pulse rounded-lg bg-slate-100"},e))})]}):u?(0,l.jsx)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"실적 리포트"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u})]}),(0,l.jsx)("button",{type:"button",onClick:()=>m(),className:"rounded-lg bg-slate-100 px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200",children:"다시 시도"})]})}):(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"실적 리포트"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"쿠팡 파트너스 실적 (매일 오후 15:00 업데이트)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[[7,14,30].map(s=>(0,l.jsxs)("button",{type:"button",onClick:()=>t(s),className:"rounded-full px-3 py-1 text-xs font-medium transition ".concat(e===s?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[s,"일"]},s)),(0,l.jsx)("button",{type:"button",onClick:()=>m(),className:"ml-2 rounded-lg border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-50",children:"새로고침"})]})]}),(0,l.jsxs)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-blue-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"총 클릭"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eI(h.totalClicks)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["전환율: ",h.conversionRate.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-green-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"총 주문"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eI(h.totalOrders)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["평균: ",eT(h.avgOrderValue)]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-red-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"총 취소"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eI(h.totalCancels)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["취소율: ",h.cancelRate.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-purple-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"총 수익"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eT(h.totalCommission)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["GMV: ",eT(h.totalGmv)]})]})]}),(0,l.jsx)("div",{className:"mt-6 overflow-hidden rounded-lg border border-slate-200",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600",children:"날짜"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"클릭"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"주문"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"취소"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"수익"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:p.slice(0,10).map((e,t)=>{var s,a,r,c;let d=n.find(t=>t.date===e.date),x=i.find(t=>t.date===e.date),u=o.find(t=>t.date===e.date);return(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,l.jsxs)("td",{className:"px-4 py-3 text-sm text-slate-600",children:[e.date.slice(4,6),"/",e.date.slice(6,8)]}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm text-slate-900",children:eI(null!=(s=e.clicks)?s:0)}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm text-slate-900",children:d?eI(null!=(a=d.orderCnt)?a:0):"-"}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm text-red-600",children:x?eI(null!=(r=x.cancelCnt)?r:0):"-"}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm font-medium text-slate-900",children:u?eT(null!=(c=u.commission)?c:0):"-"})]},"".concat(e.date,"-").concat(t))})})]})})]}):(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"실적 리포트"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-slate-500",children:"쿠팡 파트너스 API를 연동하면 실적 데이터를 확인할 수 있습니다."}),(0,l.jsx)("a",{href:"/admin/settings",className:"mt-4 inline-block text-sm font-medium text-blue-600 hover:underline",children:"설정 페이지로 이동 →"})]})}function eH(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t).concat(s).concat(l)}async function eR(e,t,s,l){let a=new Date,r=new Date;r.setDate(a.getDate()-l+1);let n=await fetch("/api/coupang/ads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessKey:e,secretKey:t,endpoint:s,startDate:eH(r),endDate:eH(a)})});if(!n.ok)throw Error((await n.json()).message||"광고 리포트 조회 실패");let i=await n.json();if(!i.success)throw Error(i.message||"광고 리포트 조회 실패");return i.data}function eK(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,{settings:t}=(0,ee.C)(),{coupang:s}=t,l=s.enabled&&!!s.accessKey&&!!s.secretKey,{data:a=[],isLoading:r,error:n,refetch:i}=(0,y.I)({queryKey:["coupang","ads","impression-click",e],queryFn:()=>eR(s.accessKey,s.secretKey,"impression-click",e),enabled:l,staleTime:9e5,refetchOnWindowFocus:!1}),{data:o=[],isLoading:c,error:d,refetch:x}=(0,y.I)({queryKey:["coupang","ads","orders",e],queryFn:()=>eR(s.accessKey,s.secretKey,"orders",e),enabled:l,staleTime:9e5,refetchOnWindowFocus:!1}),{data:u=[],isLoading:m,error:h,refetch:p}=(0,y.I)({queryKey:["coupang","ads","cancels",e],queryFn:()=>eR(s.accessKey,s.secretKey,"cancels",e),enabled:l,staleTime:9e5,refetchOnWindowFocus:!1}),{data:b=[],isLoading:g,error:f,refetch:v}=(0,y.I)({queryKey:["coupang","ads","performance",e],queryFn:()=>eR(s.accessKey,s.secretKey,"performance",e),enabled:l,staleTime:9e5,refetchOnWindowFocus:!1}),{data:j=[],isLoading:w,error:N,refetch:k}=(0,y.I)({queryKey:["coupang","ads","commission",e],queryFn:()=>eR(s.accessKey,s.secretKey,"commission",e),enabled:l,staleTime:9e5,refetchOnWindowFocus:!1}),C={totalImpressions:a.reduce((e,t)=>{var s;return e+(null!=(s=t.impression)?s:0)},0),totalClicks:a.reduce((e,t)=>{var s;return e+(null!=(s=t.click)?s:0)},0),totalOrders:o.length,totalCancels:u.length,totalCommission:j.reduce((e,t)=>{var s;return e+(null!=(s=t.commission)?s:0)},0),totalGmv:o.reduce((e,t)=>{var s;return e+(null!=(s=t.gmv)?s:0)},0),avgEcpm:b.length>0?b.reduce((e,t)=>{var s;return e+(null!=(s=t.ecpm)?s:0)},0)/b.length:0,ctr:a.reduce((e,t)=>{var s;return e+(null!=(s=t.impression)?s:0)},0)>0?a.reduce((e,t)=>{var s;return e+(null!=(s=t.click)?s:0)},0)/a.reduce((e,t)=>{var s;return e+(null!=(s=t.impression)?s:0)},0)*100:0};return{impressionClick:a,orders:o,cancels:u,performance:b,commission:j,summary:C,isEnabled:l,isLoading:r||c||m||g||w,error:(null==n?void 0:n.message)||(null==d?void 0:d.message)||(null==h?void 0:h.message)||(null==f?void 0:f.message)||(null==N?void 0:N.message)||null,refetch:()=>{i(),x(),p(),v(),k()}}}function eW(e){return new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(e)}function eP(e){return e.toLocaleString()}function eE(){let[e,t]=(0,a.useState)(7),{impressionClick:s,orders:r,cancels:n,performance:i,commission:o,summary:c,isEnabled:d,isLoading:x,error:u,refetch:m}=eK(e),h=(0,a.useMemo)(()=>{let e=new Map;return s.forEach(t=>{var s,l;let a=e.get(t.date)||{impressions:0,clicks:0,orders:0,cancels:0,commission:0,ecpm:0};a.impressions+=null!=(s=t.impression)?s:0,a.clicks+=null!=(l=t.click)?l:0,e.set(t.date,a)}),r.forEach(t=>{let s=e.get(t.date)||{impressions:0,clicks:0,orders:0,cancels:0,commission:0,ecpm:0};s.orders+=1,e.set(t.date,s)}),n.forEach(t=>{let s=e.get(t.date)||{impressions:0,clicks:0,orders:0,cancels:0,commission:0,ecpm:0};s.cancels+=1,e.set(t.date,s)}),o.forEach(t=>{var s;let l=e.get(t.date)||{impressions:0,clicks:0,orders:0,cancels:0,commission:0,ecpm:0};l.commission+=null!=(s=t.commission)?s:0,e.set(t.date,l)}),i.forEach(t=>{var s;let l=String(t.date),a=e.get(l)||{impressions:0,clicks:0,orders:0,cancels:0,commission:0,ecpm:0};a.ecpm=null!=(s=t.ecpm)?s:0,e.set(l,a)}),Array.from(e.entries()).map(e=>{let[t,s]=e;return{date:t,...s}}).sort((e,t)=>t.date.localeCompare(e.date))},[s,r,n,o,i]);return d?x?(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"광고 배너 리포트"}),(0,l.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,l.jsx)("div",{className:"h-24 animate-pulse rounded-lg bg-slate-100"},e))})]}):u?(0,l.jsx)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"광고 배너 리포트"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-red-500",children:u})]}),(0,l.jsx)("button",{type:"button",onClick:()=>m(),className:"rounded-lg bg-slate-100 px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200",children:"다시 시도"})]})}):(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"광고 배너 리포트"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"카테고리 & 다이나믹 배너 (최대 14일 조회 가능)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[[7,14].map(s=>(0,l.jsxs)("button",{type:"button",onClick:()=>t(s),className:"rounded-full px-3 py-1 text-xs font-medium transition ".concat(e===s?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[s,"일"]},s)),(0,l.jsx)("button",{type:"button",onClick:()=>m(),className:"ml-2 rounded-lg border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-50",children:"새로고침"})]})]}),(0,l.jsxs)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-indigo-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"총 노출"}),(0,l.jsxs)("svg",{className:"h-5 w-5 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eP(c.totalImpressions)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["클릭: ",eP(c.totalClicks)," (",c.ctr.toFixed(2),"%)"]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-teal-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"광고 주문"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-teal-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eP(c.totalOrders)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["취소: ",eP(c.totalCancels)]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-amber-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"평균 eCPM"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eW(c.avgEcpm)}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"노출 1,000회당 수익"})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-gradient-to-br from-emerald-50 to-white p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"광고 수익"}),(0,l.jsx)("svg",{className:"h-5 w-5 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,l.jsx)("p",{className:"mt-3 text-2xl font-bold text-slate-900",children:eW(c.totalCommission)}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["GMV: ",eW(c.totalGmv)]})]})]}),(0,l.jsx)("div",{className:"mt-6 overflow-hidden rounded-lg border border-slate-200",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-slate-600",children:"날짜"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"노출"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"클릭"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"주문"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"eCPM"}),(0,l.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-slate-600",children:"수익"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white",children:h.slice(0,10).map(e=>{let t=e.impressions>0?e.clicks/e.impressions*100:0;return(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,l.jsxs)("td",{className:"px-4 py-3 text-sm text-slate-600",children:[e.date.slice(4,6),"/",e.date.slice(6,8)]}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm text-slate-900",children:eP(e.impressions)}),(0,l.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-slate-900",children:[eP(e.clicks),(0,l.jsxs)("span",{className:"ml-1 text-xs text-slate-500",children:["(",t.toFixed(1),"%)"]})]}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm text-slate-900",children:eP(e.orders)}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm font-medium text-amber-600",children:e.ecpm>0?eW(e.ecpm):"-"}),(0,l.jsx)("td",{className:"px-4 py-3 text-right text-sm font-medium text-slate-900",children:e.commission>0?eW(e.commission):"-"})]},e.date)})})]})})]}):(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"광고 배너 리포트"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-slate-500",children:"쿠팡 파트너스 API를 연동하면 광고 배너 실적 데이터를 확인할 수 있습니다."}),(0,l.jsx)("a",{href:"/admin/settings",className:"mt-4 inline-block text-sm font-medium text-blue-600 hover:underline",children:"설정 페이지로 이동 →"})]})}function eB(e){return new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(e)}function e_(){let[e,t]=(0,a.useState)(7),{performance:s,commission:r,impressionClick:n,summary:i,isEnabled:o,isLoading:c,error:d,refetch:x}=eK(e),u=(0,a.useMemo)(()=>{let t=[],l=new Date;for(let s=e-1;s>=0;s--){let e=new Date(l);e.setDate(l.getDate()-s);let a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");t.push("".concat(a).concat(r).concat(n))}let a=new Map;s.forEach(e=>{var t;let s=String(e.date);a.set(s,null!=(t=e.ecpm)?t:0)});let r=t.map(e=>{var t;return{date:e,dateLabel:function(e){if(!e||8!==e.length)return e;let t=e.slice(4,6),s=e.slice(6,8);return"".concat(t,"/").concat(s)}(e),value:null!=(t=a.get(e))?t:0}}),n=Math.max(...r.map(e=>e.value),1);return r.map(e=>({...e,percentage:e.value>0?e.value/n*100:0}))},[s,e]),m=(0,a.useMemo)(()=>{var e,t,s,l;let a=null!=(e=null==i?void 0:i.totalImpressions)?e:0,r=null!=(t=null==i?void 0:i.totalClicks)?t:0,n=null!=(s=null==i?void 0:i.totalCommission)?s:0;return{avgEcpm:null!=(l=null==i?void 0:i.avgEcpm)?l:0,totalImpressions:a,totalClicks:r,totalCommission:n,ctr:a>0?r/a*100:0}},[i]);return o?c?(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"eCPM 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"데이터를 불러오는 중..."})]})}),(0,l.jsx)("div",{className:"mt-6 h-40 animate-pulse rounded-2xl bg-slate-100"})]}):d?(0,l.jsx)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"eCPM 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-red-500",children:d})]}),(0,l.jsx)("button",{type:"button",onClick:()=>x(),className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-600 hover:bg-slate-200",children:"다시 시도"})]})}):(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"eCPM 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"광고 배너 실적 (매일 오후 15:00 업데이트)"})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:[7,14].map(s=>(0,l.jsxs)("button",{type:"button",onClick:()=>t(s),className:"rounded-full px-3 py-1 text-xs font-medium transition ".concat(e===s?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[s,"일"]},s))})]}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[u.length>0&&(0,l.jsxs)("div",{className:"flex h-48 flex-col justify-between py-2 text-xs text-slate-500",children:[(0,l.jsx)("div",{className:"text-right",children:eB(Math.max(...u.map(e=>e.value)))}),(0,l.jsx)("div",{className:"text-right",children:eB(Math.max(...u.map(e=>e.value))/2)}),(0,l.jsx)("div",{className:"text-right",children:"₩0"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"h-48 rounded-2xl border border-slate-200 bg-gradient-to-b from-amber-50 to-white p-4",children:u.length>0?(0,l.jsx)("div",{className:"flex h-full items-end justify-center gap-2",children:u.map(e=>(0,l.jsxs)("div",{className:"group relative flex h-full flex-col justify-end",style:{width:"".concat(100/u.length-2,"%"),maxWidth:"40px"},children:[(0,l.jsx)("div",{style:{height:e.percentage>0?"".concat(e.percentage,"%"):"0"},className:"w-full rounded-t-md bg-amber-500 transition-all group-hover:bg-amber-600"}),(0,l.jsxs)("div",{className:"absolute bottom-full left-1/2 mb-2 hidden -translate-x-1/2 whitespace-nowrap rounded-lg bg-slate-900 px-3 py-1.5 text-xs text-white shadow-lg group-hover:block",children:[(0,l.jsx)("div",{className:"font-medium",children:e.dateLabel}),(0,l.jsx)("div",{className:"text-amber-200",children:eB(e.value)})]})]},e.date))}):(0,l.jsx)("div",{className:"flex h-full items-center justify-center text-sm text-slate-400",children:"데이터가 없습니다"})}),u.length>0&&(0,l.jsx)("div",{className:"mt-2 flex justify-center gap-2 text-[10px] text-slate-500",children:u.map((t,s)=>{let a=7===e||14===e&&s%2==0;return(0,l.jsx)("div",{className:"text-center",style:{width:"".concat(100/u.length-2,"%"),maxWidth:"40px"},children:a?t.dateLabel:""},t.date)})})]})]}),(0,l.jsxs)("dl",{className:"mt-6 grid grid-cols-2 gap-4 text-xs text-slate-600 sm:grid-cols-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"평균 eCPM"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:eB(m.avgEcpm)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"총 노출"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:m.totalImpressions.toLocaleString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"총 클릭"}),(0,l.jsx)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:m.totalClicks.toLocaleString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("dt",{className:"font-semibold text-slate-500",children:"CTR"}),(0,l.jsxs)("dd",{className:"mt-1 text-base font-semibold text-slate-900",children:[m.ctr.toFixed(2),"%"]})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-between border-t border-slate-100 pt-4 text-xs text-slate-500",children:[(0,l.jsx)("div",{className:"flex gap-4",children:(0,l.jsxs)("span",{children:["광고 수익:"," ",(0,l.jsx)("strong",{className:"text-slate-700",children:eB(m.totalCommission)})]})}),(0,l.jsx)("button",{type:"button",onClick:()=>x(),className:"font-medium text-blue-600 hover:underline",children:"새로고침"})]})]}):(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"eCPM 추이"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"쿠팡 파트너스 API를 연동하면 광고 eCPM 데이터를 확인할 수 있습니다."})]})}),(0,l.jsx)("div",{className:"mt-6 flex h-40 items-center justify-center rounded-2xl bg-slate-50",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"쿠팡 API 연동 필요"}),(0,l.jsx)("a",{href:"/admin/settings",className:"mt-2 inline-block text-xs font-medium text-blue-600 hover:underline",children:"설정 페이지로 이동"})]})})]})}let ez=ep.map(e=>e.value);function eO(e){let{view:t="overview",title:s,description:h}=e,{status:f,user:v}=(0,n.D)(),{reviewStatuses:j,reviewLimitFilter:w,reviewSearch:y,reviewDateFilter:k,selectedReviewId:C,logLevels:L,logSearch:M,logDateFilter:S,setReviewStatus:A,setReviewLimitFilter:D,setReviewSearch:T,setReviewDateFilter:I,setSelectedReview:F,setLogLevel:H,setLogLevels:R,setLogSearch:K,setLogDateFilter:W,setReviewPageIndex:P,setLogPageIndex:E}=N(),B=eg[t],_=null!=s?s:B.title,z=null!=h?h:B.description,O="overview"===t||"reviews"===t,q=(0,r.useRouter)(),G=(0,r.usePathname)(),V=(0,r.useSearchParams)(),U=(0,a.useMemo)(()=>V.toString(),[V]),Y=(0,a.useCallback)(e=>{let t=new URLSearchParams(U),s=!1;if(Object.entries(e).forEach(e=>{let[l,a]=e,r=null!=a?a:"",n=t.get(l);r?n!==r&&(t.set(l,r),s=!0):null!==n&&(t.delete(l),s=!0)}),!s)return;let l=t.toString();q.replace(l?"".concat(G,"?").concat(l):G,{scroll:!1})},[G,q,U]),{metrics:Q}=function(){let{commission:e,clicks:t,orders:s,isEnabled:l,isLoading:r,error:n}=ea(30);return{metrics:(0,a.useMemo)(()=>{if(!l)return[{id:"week-commission",label:"이번주 커미션",value:"-",trend:"API 미연동"},{id:"conversion",label:"클릭 → 주문 전환율",value:"-",trend:"API 미연동"},{id:"today-clicks",label:"금일 클릭 수",value:"-",trend:"API 미연동"}];if(r)return[{id:"week-commission",label:"이번주 커미션",value:"...",trend:"로딩 중"},{id:"conversion",label:"클릭 → 주문 전환율",value:"...",trend:"로딩 중"},{id:"today-clicks",label:"금일 클릭 수",value:"...",trend:"로딩 중"}];if(n||!e.length||!t.length||!s.length)return[{id:"week-commission",label:"이번주 커미션",value:"₩0"},{id:"conversion",label:"클릭 → 주문 전환율",value:"0.0%"},{id:"today-clicks",label:"금일 클릭 수",value:"0"}];let a=ei(new Date),i=en(),o=function(){let e=new Date(en().start);e.setDate(e.getDate()-1);let t=new Date(e);return t.setDate(e.getDate()-6),t.setHours(0,0,0,0),{start:t,end:e}}(),c=ei(i.start),d=ei(i.end),x=ei(o.start),u=ei(o.end),m=e.filter(e=>e.date>=c&&e.date<=d).reduce((e,t)=>e+t.commission,0),h=e.filter(e=>e.date>=x&&e.date<=u).reduce((e,t)=>e+t.commission,0),p=h>0?(m-h)/h*100:0,b=t.filter(e=>e.date===a).reduce((e,t)=>e+t.clicks,0),g=new Date;g.setDate(g.getDate()-1);let f=ei(g),v=t.filter(e=>e.date===f).reduce((e,t)=>e+t.clicks,0),j=v>0?(b-v)/v*100:0,w=new Date;w.setDate(w.getDate()-7);let N=ei(w),y=t.filter(e=>e.date>=N&&e.date<=a).reduce((e,t)=>e+t.clicks,0),k=s.filter(e=>e.date>=N&&e.date<=a).reduce((e,t)=>e+t.orderCnt,0),C=y>0?k/y*100:0,L=new Date;L.setDate(L.getDate()-14);let M=ei(L),S=t.filter(e=>e.date>=M&&e.date<N).reduce((e,t)=>e+t.clicks,0),A=s.filter(e=>e.date>=M&&e.date<N).reduce((e,t)=>e+t.orderCnt,0),D=C-(S>0?A/S*100:0);return[{id:"week-commission",label:"이번주 커미션",value:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(m),trend:0!==p?"".concat(p>0?"+":"").concat(er(p)," WoW"):void 0},{id:"conversion",label:"클릭 → 주문 전환율",value:er(C),trend:0!==D?"".concat(D>0?"+":"").concat(D.toFixed(1),"pp"):void 0},{id:"today-clicks",label:"금일 클릭 수",value:b.toLocaleString(),trend:0!==j?"".concat(j>0?"+":"").concat(er(j)," DoD"):void 0}]},[e,t,s,l,r,n]),isEnabled:l,isLoading:r,error:n}}(),{metrics:Z,workflow:X,logs:J,isLoading:ee,reviewLimit:et,setReviewLimit:es,hasNextReviewPage:el,hasPrevReviewPage:eo,goToNextReviewPage:ex,goToPrevReviewPage:em,reviewPageIndex:eh,totalReviewCount:ef,hasNextLogPage:ev,hasPrevLogPage:ej,goToNextLogPage:eL,goToPrevLogPage:eM,logPageIndex:eT,totalLogCount:eI,refreshReviews:eH}=function(e){var t,s,l;let{status:r}=(0,n.D)(),h=null==e?void 0:e.reviewStatusFilter,f=null!=(t=null==e?void 0:e.reviewDateRange)?t:"all",v=null==e?void 0:e.logLevelFilter,j=null!=(s=null==e?void 0:e.logDateRange)?s:"all",w=(0,a.useMemo)(()=>g(h,x),[h]),N=(0,a.useMemo)(()=>g(v,u),[v]),[y,k]=(0,a.useState)(o),[C,L]=(0,a.useState)(c),[M,S]=(0,a.useState)(d),[A,D]=(0,a.useState)(!1),[T,I]=(0,a.useState)(null!=(l=null==e?void 0:e.defaultReviewLimit)?l:12),F=null==e?void 0:e.onReviewPageChange,[H,R]=(0,a.useState)(null),[K,W]=(0,a.useState)(!1),[P,E]=(0,a.useState)(!1),[B,_]=(0,a.useState)(0),[z,O]=(0,a.useState)(null),[q,G]=(0,a.useState)(!1),[V,U]=(0,a.useState)(!1),[Y,Q]=(0,a.useState)(0),Z=null==e?void 0:e.onLogPageChange,X=(0,a.useRef)([]),J=(0,a.useRef)(null),$=(0,a.useRef)([]),ee=(0,a.useRef)(null),et=(0,a.useCallback)(e=>{I(t=>e===t?t:e)},[]);(0,a.useEffect)(()=>{let e=[];return"ready"!==r?()=>{e.forEach(e=>e())}:(async function(){let t=await (0,i.xN)("earnings",8,e=>{k(e.length?e.map(e=>{var t,s,l;return{id:e.id,label:null!=(t=e.date)?t:"N/A",value:null!=(l=e.value)?l:"".concat(null!=(s=e.commission)?s:0),trend:e.trend}}):o)});e.push(t)}(),()=>{e.forEach(e=>e())})},[r]);let es=(0,a.useCallback)(async function(){let{cursor:e,resetStack:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("ready"!==r){L(c),W(!1),E(!1),_(0),null==F||F(0);return}t&&(X.current=[],J.current=null);let s=b(h,x);if(0===s.length){X.current=[],J.current=null,L([]),R(0),W(!1),E(!1),_(0),null==F||F(0);return}D(!0);try{var l;let t=s.length===x.length?void 0:s,a=p(f),r=await (0,i.EZ)({limit:T,startAfterDoc:null!=e?e:null,statuses:t,updatedAfter:a});L(r.documents.length?r.documents.map(e=>{var t,s,l,a,r;return{id:e.id,productId:e.productId,product:null!=(s=null!=(t=e.productName)?t:e.productId)?s:"미상",author:null!=(l=e.author)?l:"auto-bot",status:null!=(a=e.status)?a:"draft",updatedAt:null!=(r=e.updatedAt)?r:"",createdAt:e.createdAt,content:e.content,toneScore:e.toneScore,charCount:e.charCount}}):c),R(null!=(l=r.totalCount)?l:null),J.current=r.lastSnapshot,W(r.hasMore),E(X.current.length>0);let n=X.current.length;_(n),null==F||F(n)}catch(e){console.warn("[useAdminDashboardData] Failed to fetch review page",e),L(c),R(null),W(!1),E(X.current.length>0)}finally{D(!1)}},[r,T,h,w,f,F]);(0,a.useEffect)(()=>{"ready"===r&&es({cursor:null,resetStack:!0}).catch(e=>{console.warn("[useAdminDashboardData] Initial review page load failed",e)})},[r,T,es]);let el=(0,a.useCallback)(async()=>{J.current&&K&&(X.current=[...X.current,J.current],await es({cursor:J.current}))},[K,es]),ea=(0,a.useCallback)(async()=>{var e;if(0===X.current.length)return;X.current=X.current.slice(0,-1);let t=null!=(e=X.current[X.current.length-1])?e:null;await es({cursor:null!=t?t:null})},[es]),er=(0,a.useCallback)(async function(){let{cursor:e,resetStack:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("ready"!==r){S(d),O(null),G(!1),U(!1),Q(0);return}t&&($.current=[],ee.current=null);try{var s;let t=b(v,u);if(0===t.length){$.current=[],ee.current=null,S([]),O(0),G(!1),U(!1),Q(0),null==Z||Z(0);return}let l=t.length===u.length?void 0:t,a=p(j),r=await (0,i.e_)({limit:12,startAfterDoc:null!=e?e:null,levels:l,createdAfter:a});S(r.documents.length?r.documents.map(m):d),O(null!=(s=r.totalCount)?s:null),ee.current=r.lastSnapshot,G(r.hasMore),U($.current.length>0);let n=$.current.length;Q(n),null==Z||Z(n)}catch(e){console.warn("[useAdminDashboardData] Failed to fetch log page",e),S(d),G(!1),U($.current.length>0)}},[r,v,N,j,Z]);(0,a.useEffect)(()=>{"ready"===r&&er({cursor:null,resetStack:!0}).catch(e=>{console.warn("[useAdminDashboardData] Initial log page load failed",e)})},[r,er]);let en=(0,a.useCallback)(async()=>{ee.current&&q&&($.current=[...$.current,ee.current],await er({cursor:ee.current}))},[q,er]),ei=(0,a.useCallback)(async()=>{var e;if(0===$.current.length)return;$.current=$.current.slice(0,-1);let t=null!=(e=$.current[$.current.length-1])?e:null;await er({cursor:t})},[er]),eo=(0,a.useCallback)(async()=>{await es({cursor:null,resetStack:!0})},[es]),ec=(0,a.useCallback)(async()=>{await er({cursor:null,resetStack:!0})},[er]);return(0,a.useMemo)(()=>({metrics:y,workflow:C,logs:M,isLoading:A,reviewLimit:T,setReviewLimit:et,hasNextReviewPage:K,hasPrevReviewPage:P,goToNextReviewPage:el,goToPrevReviewPage:ea,reviewPageIndex:B,totalReviewCount:H,hasNextLogPage:q,hasPrevLogPage:V,goToNextLogPage:en,goToPrevLogPage:ei,logPageIndex:Y,totalLogCount:z,refreshReviews:eo,refreshLogs:ec}),[y,C,M,A,T,et,K,P,el,ea,B,H,q,V,en,ei,Y,z,eo,ec])}({defaultReviewLimit:w,onReviewPageChange:P,onLogPageChange:E,reviewStatusFilter:j,reviewDateRange:k,logLevelFilter:L,logDateRange:S}),[eR,eK]=(0,a.useState)(null),[eW,eP]=(0,a.useState)(null),[eB,eO]=(0,a.useState)(null),[eq,eG]=(0,a.useState)(null),[eV,eU]=(0,a.useState)([]),[eY,eQ]=(0,a.useState)(!1),[eZ,eX]=(0,a.useState)(!1),[eJ,e$]=(0,a.useState)(null),e0=(0,a.useMemo)(()=>{if("ready"===f&&v){var e;return"".concat(null!=(e=v.email)?e:"관리자","님,")}return"관리자님,"},[f,v]),e2="ready"===f;(0,a.useEffect)(()=>{var e,t;let s=new URLSearchParams(U),l=null!=(e=s.get("reviewSearch"))?e:"";l!==y&&T(l);let a=s.get("reviewDate"),r=ez.includes(a);a&&r?a!==k&&I(a):"all"!==k&&I("all");let n=null!=(t=s.get("logSearch"))?t:"";n!==M&&K(n);let i=s.get("logDate"),o=ez.includes(i);i&&o?i!==S&&W(i):"all"!==S&&W("all");let c=s.get("logLevels"),d=null;if(c){let e=c.split(",").map(e=>e.trim()).filter(e=>eu.includes(e));e.length>0&&(d=eu.reduce((t,s)=>(t[s]=e.includes(s),t),{}))}let x=null!=d?d:eu.reduce((e,t)=>(e[t]=!0,e),{});eu.some(e=>{var t;return(null!=(t=L[e])&&t)!==x[e]})&&R(x)},[U,I,W,R,K,T]),(0,a.useEffect)(()=>{let e=eu.filter(e=>L[e]);Y({reviewSearch:y.trim()?y.trim():null,reviewDate:"all"===k?null:k,logSearch:M.trim()?M.trim():null,logDate:"all"===S?null:S,logLevels:e.length===eu.length?null:e.join(",")})},[S,L,M,k,y,Y]);let e1=(0,a.useMemo)(()=>{let e=y.trim().toLowerCase(),t=Date.now();return X.filter(s=>{var l,a,r,n,i,o,c,d,x,u,m;if(!s.status||!(null!=(l=j[s.status])&&l)||e&&![null!=(o=null==(a=s.product)?void 0:a.toLowerCase())?o:"",null!=(c=null==(r=s.productId)?void 0:r.toLowerCase())?c:"",null!=(d=null==(n=s.author)?void 0:n.toLowerCase())?d:"",null!=(x=null==(i=s.content)?void 0:i.toLowerCase())?x:""].some(t=>t.includes(e)))return!1;if("all"!==k){let e=null!=(m=null!=(u=s.updatedAt)?u:s.createdAt)?m:"",l=e?new Date(e):null;if(!l||Number.isNaN(l.getTime())||t-l.getTime()>eb[k])return!1}return!0})},[k,y,j,X]),e4=(0,a.useMemo)(()=>e1.filter(e=>!!e.id),[e1]),e5=(0,a.useMemo)(()=>{let e=M.trim().toLowerCase(),t=Date.now();return J.filter(s=>{var l,a,r,n,i;if(!(null!=(r=L[s.level])&&r))return!1;if("all"!==S){let e=s.createdAt?new Date(s.createdAt):null;if(!e||Number.isNaN(e.getTime())||t-e.getTime()>eb[S])return!1}if(!e)return!0;let o=null!=(n=null==(l=s.message)?void 0:l.toLowerCase())?n:"",c=null!=(i=null==(a=s.context)?void 0:a.toLowerCase())?i:"";return o.includes(e)||c.includes(e)})},[S,L,M,J]);(0,a.useEffect)(()=>{if(!C)return void eG(null);let e=e1.find(e=>e.id===C);e?eG(e):(F(null),eG(null))},[e1,C,F]),(0,a.useEffect)(()=>{eU(e=>e.filter(e=>e4.some(t=>t.id===e)))},[e4]),(0,a.useEffect)(()=>{w!==et&&es(w)},[w,et,es]),(0,a.useEffect)(()=>{et!==w&&D(et)},[et,w,D]);let e6=(0,a.useCallback)(e=>T(e.target.value),[T]),e3=(0,a.useCallback)(()=>T(""),[T]),e9=(0,a.useCallback)(e=>I(e),[I]),e8=(0,a.useCallback)(e=>K(e.target.value),[K]),e7=(0,a.useCallback)(()=>K(""),[K]),te=(0,a.useCallback)(e=>W(e),[W]),tt=(0,a.useCallback)(e=>{if(!e.id)return void eG(e);F(e.id)},[F]),ts=(0,a.useCallback)((e,t)=>{eU(s=>t?s.includes(e)?s:[...s,e]:s.filter(t=>t!==e))},[]),tl=(0,a.useCallback)(e=>{e?eU(e4.map(e=>e.id).filter(Boolean)):eU([])},[e4]),ta=(0,a.useCallback)(async(e,t,s)=>{if(!e)return void eP("실제 리뷰 ID를 찾을 수 없어 변경할 수 없습니다.");eK(e),eP(null),eO(null);try{var l;await (0,i.WD)(e,s),await (0,i.hc)("admin_actions",{reviewId:e,product:t,nextStatus:s,source:"dashboard",performedAt:new Date().toISOString()}),eU(t=>t.filter(t=>t!==e)),eO("'".concat(t,"' 처리 결과: ").concat(null!=(l=ec[s])?l:s,".")),await eH()}catch(e){eP(e instanceof Error?e.message:"리뷰 상태 변경 중 알 수 없는 오류가 발생했습니다.")}finally{eK(null)}},[eH]),tr=(0,a.useCallback)(()=>{e$(null),eX(!0)},[]),tn=(0,a.useCallback)(e=>{e$(e),eX(!0)},[]),ti=(0,a.useCallback)(()=>{eX(!1),e$(null)},[]),to=(0,a.useCallback)(async()=>{eO("리뷰가 저장되었습니다."),await eH()},[eH]),tc=(0,a.useCallback)(async e=>{if(!eV.length)return void eP("선택된 리뷰가 없습니다.");let t=e4.filter(e=>e.id&&eV.includes(e.id));eQ(!0),eP(null),eO(null);try{var s;await Promise.all(t.map(t=>(0,i.WD)(t.id,e))),await (0,i.hc)("admin_actions",{reviewIds:t.map(e=>e.id),products:t.map(e=>({id:e.id,product:e.product})),nextStatus:e,source:"dashboard-bulk",performedAt:new Date().toISOString()}),eO("선택한 ".concat(t.length,"건을 '").concat(null!=(s=ec[e])?s:e,"' 상태로 변경했습니다.")),eU([]),await eH()}catch(e){eP(e instanceof Error?e.message:"일괄 상태 변경 중 알 수 없는 오류가 발생했습니다.")}finally{eQ(!1)}},[e4,eV,eH]);return(0,l.jsxs)("div",{className:"bg-slate-50",children:[(0,l.jsxs)("div",{className:"mx-auto flex max-w-6xl flex-col gap-12 px-6 py-12 sm:px-8",children:[(0,l.jsxs)("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-500",children:e0}),(0,l.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl",children:_}),(0,l.jsx)("p",{className:"mt-2 max-w-2xl text-sm text-slate-600",children:z})]}),(0,l.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-xs text-slate-500 shadow-sm",children:[(0,l.jsx)("p",{className:"font-semibold text-slate-700",children:"현재 상태"}),(0,l.jsx)("p",{className:"mt-1 text-xs",children:"ready"===f?"Firebase 연결 완료":"Firebase 초기화 중"})]})]}),ee&&(0,l.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 text-sm text-slate-500 shadow-sm",children:"최신 데이터를 불러오는 중입니다…"}),"overview"===t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ek,{metrics:Q}),(0,l.jsx)(eC,{}),(0,l.jsx)(eF,{}),(0,l.jsx)(eE,{}),(0,l.jsx)(e_,{})]}),O&&(0,l.jsxs)(l.Fragment,{children:[eW&&(0,l.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700 shadow-sm",children:eW}),eB&&(0,l.jsx)("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700 shadow-sm",children:eB})]}),O&&(0,l.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[1.5fr_1fr]",children:[(0,l.jsxs)("article",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"후기 승인 워크플로"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"`reviews` 컬렉션의 상태 값(draft → needs_revision → approved → published)을 가이드합니다."})]}),(0,l.jsx)("button",{type:"button",onClick:tr,className:"rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold text-white transition hover:bg-slate-800",children:"+ 새 리뷰 작성"})]}),(0,l.jsx)("div",{className:"mt-5 flex flex-wrap gap-2",children:ed.map(e=>{let t=j[e];return(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 text-xs font-semibold transition ".concat(t?"bg-slate-900 text-white":"border border-slate-200 text-slate-600 hover:bg-slate-100"),onClick:()=>A(e,!t),children:e.replace("_"," ")},e)})}),(0,l.jsxs)("div",{className:"mt-4 flex flex-col gap-3 text-xs text-slate-500 lg:flex-row lg:items-end lg:justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2 lg:max-w-sm",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-600",children:"상품/작성자 검색"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"search",value:y,onChange:e6,placeholder:"상품명, 작성자, 본문 키워드",className:"flex-1 rounded-full border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-300/40"}),y&&(0,l.jsx)("button",{type:"button",onClick:e3,className:"rounded-full border border-slate-200 px-3 py-2 font-semibold text-slate-600 transition hover:bg-slate-100",children:"지우기"})]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-600",children:"기간"}),ep.map(e=>(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 font-semibold transition ".concat(k===e.value?"bg-slate-900 text-white shadow-sm":"border border-slate-200 text-slate-600 hover:bg-slate-100"),onClick:()=>e9(e.value),children:e.label},e.value))]})]}),(0,l.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[(0,l.jsxs)("p",{children:["총",(0,l.jsxs)("span",{className:"font-semibold text-slate-600",children:[" ",null!=ef?ef:X.length]}),"건 중 현재",(0,l.jsxs)("span",{className:"font-semibold text-slate-600",children:[" ",e1.length]}),"건을 표시합니다."]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:"표시 개수"}),[12,24,48].map(e=>(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 font-semibold transition ".concat(et===e?"bg-slate-900 text-white":"border border-slate-200 text-slate-600 hover:bg-slate-100"),onClick:()=>D(e),children:e},e))]})]}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)(eA,{selectedCount:eV.length,isPending:eY,onBulkStatusChange:tc,onClearSelection:()=>eU([])})}),(0,l.jsx)("div",{className:"mt-5",children:(0,l.jsx)(ew,{reviews:e1,selectedReviewId:C,selectedReviewIds:eV,isInteractive:e2,pendingReviewId:eR,onRowSelect:tt,onToggleSelection:ts,onSelectAll:tl,onStatusChange:ta,onEditReview:tn})}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)(eD,{pageIndex:eh,hasNext:el,hasPrev:eo,onNext:ex,onPrev:em})}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(eN,{review:eq})})]}),(0,l.jsx)(eS,{})]}),("overview"===t||"logs"===t)&&(0,l.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"자동화 로그 스트림"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Cloud Functions, Firestore Trigger, Slack 알림 결과를 요약합니다."})]}),(0,l.jsx)("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:eu.map(e=>(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 font-semibold transition ".concat(L[e]?"bg-slate-900 text-white":"border border-slate-200 text-slate-600 hover:bg-slate-100"),onClick:()=>H(e,!L[e]),children:e},e))})]}),(0,l.jsxs)("div",{className:"mt-4 flex flex-col gap-3 text-xs text-slate-500 xl:flex-row xl:items-end xl:justify-between",children:[(0,l.jsxs)("p",{children:["총",(0,l.jsxs)("span",{className:"font-semibold text-slate-600",children:[" ",null!=eI?eI:J.length]}),"건 중",(0,l.jsxs)("span",{className:"font-semibold text-slate-600",children:[" ",e5.length]}),"건을 표시합니다."]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"search",value:M,onChange:e8,placeholder:"메시지 또는 컨텍스트 검색",className:"rounded-full border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-300/60"}),M&&(0,l.jsx)("button",{type:"button",onClick:e7,className:"rounded-full border border-slate-200 px-3 py-2 font-semibold text-slate-600 transition hover:bg-slate-100",children:"지우기"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-600",children:"기간"}),ep.map(e=>(0,l.jsx)("button",{type:"button",className:"rounded-full px-3 py-1 font-semibold transition ".concat(S===e.value?"bg-slate-900 text-white shadow-sm":"border border-slate-200 text-slate-600 hover:bg-slate-100"),onClick:()=>te(e.value),children:e.label},e.value))]})]})]}),(0,l.jsx)("div",{className:"mt-5",children:(0,l.jsx)(ey,{logs:e5})}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)(eD,{pageIndex:eT,hasNext:ev,hasPrev:ej,onNext:eL,onPrev:eM})})]})]}),(0,l.jsx)($,{isOpen:eZ,onClose:ti,reviewId:eJ,onSaved:to})]})}function eq(){return(0,l.jsx)("div",{className:"bg-slate-50 min-h-screen",children:(0,l.jsx)("div",{className:"mx-auto max-w-6xl px-6 py-12 sm:px-8",children:(0,l.jsxs)("div",{className:"animate-pulse",children:[(0,l.jsx)("div",{className:"h-8 bg-slate-200 rounded w-64 mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-slate-100 rounded w-96 mb-8"}),(0,l.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,l.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 h-32"},e))})]})})})}function eG(e){return(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)(eq,{}),children:(0,l.jsx)(eO,{...e})})}}}]);