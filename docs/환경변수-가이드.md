# í™˜ê²½ë³€ìˆ˜ ê°€ì´ë“œ

> í”„ë¡œì íŠ¸ ì „ì²´ í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬

---

## ğŸ“‹ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ê°œìš”

```
í”„ë¡œì íŠ¸/
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ .env.local         # ë¡œì»¬ ê°œë°œìš©
â”‚   â”œâ”€â”€ .env.production    # í”„ë¡œë•ì…˜ìš© (ì„œë²„)
â”‚   â””â”€â”€ .env.example       # í…œí”Œë¦¿
â””â”€â”€ functions/
    â”œâ”€â”€ .env               # Firebase Functionsìš©
    â””â”€â”€ .env.example       # í…œí”Œë¦¿
```

---

## ğŸŒ Web í™˜ê²½ë³€ìˆ˜

### .env.local (ë¡œì»¬ ê°œë°œ)

```env
# ===========================
# ë¡œì»¬ ê°œë°œ í™˜ê²½ë³€ìˆ˜
# ===========================

# Firebase Web SDK (ê³µê°œ - í”„ë¡ íŠ¸ì—”ë“œ)
NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSyCPI1msAqKlbF83upcdEClY9xlAMhJs-3I
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=blog-automation-23092.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=blog-automation-23092
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=blog-automation-23092.firebasestorage.app
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=944342575434
NEXT_PUBLIC_FIREBASE_APP_ID=1:944342575434:web:f9ee17d38296ffe0aaf9b3
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=
NEXT_PUBLIC_FIREBASE_DATABASE_URL=https://blog-automation-23092-default-rtdb.asia-southeast1.firebasedatabase.app

# ì‚¬ì´íŠ¸ URL
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# ê´€ë¦¬ì ìš°íšŒ (ë¡œì»¬ ê°œë°œ ì‹œ ë¡œê·¸ì¸ ìƒëµ)
ADMIN_GUARD_BYPASS=true

# Node í™˜ê²½
NODE_ENV=development

# Firebase Admin SDK (ì„ íƒ - ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©)
# FIREBASE_ADMIN_PROJECT_ID=blog-automation-23092
# FIREBASE_ADMIN_CLIENT_EMAIL=...
# FIREBASE_ADMIN_PRIVATE_KEY="..."
```

---

### .env.production (í”„ë¡œë•ì…˜ - ì„œë²„)

```env
# ===========================
# í”„ë¡œë•ì…˜ í™˜ê²½ë³€ìˆ˜
# ===========================

# Firebase Web SDK (ê³µê°œ - í”„ë¡ íŠ¸ì—”ë“œ)
NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSyCPI1msAqKlbF83upcdEClY9xlAMhJs-3I
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=blog-automation-23092.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=blog-automation-23092
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=blog-automation-23092.firebasestorage.app
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=944342575434
NEXT_PUBLIC_FIREBASE_APP_ID=1:944342575434:web:f9ee17d38296ffe0aaf9b3
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=
NEXT_PUBLIC_FIREBASE_DATABASE_URL=https://blog-automation-23092-default-rtdb.asia-southeast1.firebasedatabase.app

# ì‚¬ì´íŠ¸ URL
NEXT_PUBLIC_SITE_URL=https://semolink.store

# ê´€ë¦¬ì ìš°íšŒ (í”„ë¡œë•ì…˜ì—ì„œëŠ” false)
ADMIN_GUARD_BYPASS=false

# Node í™˜ê²½
NODE_ENV=production

# Firebase Admin SDK (í•„ìˆ˜)
FIREBASE_ADMIN_PROJECT_ID=blog-automation-23092
FIREBASE_ADMIN_CLIENT_EMAIL=firebase-adminsdk-fbsvc@blog-automation-23092.iam.gserviceaccount.com
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
```

---

## âš¡ Functions í™˜ê²½ë³€ìˆ˜

### functions/.env

```env
# ===========================
# Firebase Functions í™˜ê²½ë³€ìˆ˜
# ===========================

# Coupang Partners API
COUPANG_ACCESS_KEY=your-access-key
COUPANG_SECRET_KEY=your-secret-key

# OpenAI API
OPENAI_API_KEY=sk-...

# Google Gemini API
GEMINI_API_KEY=...

# Slack Webhook (ì„ íƒ)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...

# ì´ë¯¸ì§€ ì„œë²„ URL
IMAGE_SERVER_URL=https://img.semolink.store
```

---

## ğŸ”‘ í™˜ê²½ë³€ìˆ˜ ìƒì„¸ ì„¤ëª…

### NEXT_PUBLIC_* (í´ë¼ì´ì–¸íŠ¸ ì¸¡)

**ìš©ë„:** ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ê³µê°œ í™˜ê²½ë³€ìˆ˜

**ì£¼ì˜:**
- âš ï¸ ë¯¼ê°í•œ ì •ë³´ í¬í•¨ ê¸ˆì§€ (API í‚¤, ë¹„ë°€ë²ˆí˜¸ ë“±)
- âœ… Firebase Web SDK ì„¤ì •ì€ ê³µê°œë˜ì–´ë„ ì•ˆì „ (Firebase Security Rulesë¡œ ë³´í˜¸)

**ì˜ˆì‹œ:**
```typescript
// í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©
const apiKey = process.env.NEXT_PUBLIC_FIREBASE_API_KEY;
```

---

### FIREBASE_ADMIN_* (ì„œë²„ ì¸¡)

**ìš©ë„:** ì„œë²„ ì¸¡ Firebase Admin SDK ì¸ì¦

**í•„ìš”í•œ ê²½ìš°:**
- ê´€ë¦¬ì í˜ì´ì§€ ì„¸ì…˜ ê´€ë¦¬
- ì„œë²„ ì¸¡ Firestore ì ‘ê·¼
- Custom Claims ì„¤ì •

**ìƒì„± ë°©ë²•:**
1. Firebase Console â†’ í”„ë¡œì íŠ¸ ì„¤ì •
2. ì„œë¹„ìŠ¤ ê³„ì • â†’ ìƒˆ ë¹„ê³µê°œ í‚¤ ìƒì„±
3. JSON íŒŒì¼ ë‹¤ìš´ë¡œë“œ
4. ê°’ ë³µì‚¬ â†’ .env.production

**í˜•ì‹:**
```env
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvgIB...(ì¤„ë°”ê¿ˆì€ \n ê·¸ëŒ€ë¡œ)\n-----END PRIVATE KEY-----\n"
```

---

### ADMIN_GUARD_BYPASS

**ìš©ë„:** ê´€ë¦¬ì ë¡œê·¸ì¸ ìš°íšŒ (ê°œë°œìš©)

**ê°’:**
- `true`: ë¡œê·¸ì¸ ì—†ì´ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ê°€ëŠ¥
- `false`: Firebase Authentication í•„ìš”

**ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:**
```
ë¡œì»¬ ê°œë°œ: true  (ë¹ ë¥¸ í…ŒìŠ¤íŠ¸)
í”„ë¡œë•ì…˜: false (ë³´ì•ˆ)
```

**ì£¼ì˜:**
- í”„ë¡œë•ì…˜ì—ì„œ `true`ë¡œ ì„¤ì • ì‹œ ë³´ì•ˆ ìœ„í—˜!

---

### NODE_ENV

**ìš©ë„:** Node.js ì‹¤í–‰ í™˜ê²½ êµ¬ë¶„

**ê°’:**
- `development`: ê°œë°œ ëª¨ë“œ
- `production`: í”„ë¡œë•ì…˜ ëª¨ë“œ

**ì˜í–¥:**
- ë¡œê¹… ìˆ˜ì¤€
- ì—ëŸ¬ í‘œì‹œ ìƒì„¸ë„
- ìµœì í™” ìˆ˜ì¤€
- Bypass ê¸°ëŠ¥ í™œì„±í™” ì—¬ë¶€

---

### COUPANG_* (Functions)

**ìš©ë„:** ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ API ì¸ì¦

**ìƒì„± ë°©ë²•:**
1. ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ ê°€ì…
2. API ì‹ ì²­
3. Access Key, Secret Key ë°œê¸‰
4. functions/.envì— ì„¤ì •

**ì‚¬ìš©:**
```javascript
const accessKey = process.env.COUPANG_ACCESS_KEY;
const secretKey = process.env.COUPANG_SECRET_KEY;
```

---

### AI_* (Functions)

**OPENAI_API_KEY:**
- OpenAI API í‚¤
- GPT ëª¨ë¸ë¡œ ë¦¬ë·° ìƒì„±

**GEMINI_API_KEY:**
- Google Gemini API í‚¤
- Gemini ëª¨ë¸ë¡œ ë¦¬ë·° ìƒì„±

**ì„¤ì •:**
- settings/system ë¬¸ì„œì˜ aiProviderì— ë”°ë¼ ì„ íƒì  ì‚¬ìš©

---

## ğŸ”’ ë³´ì•ˆ ê°€ì´ë“œ

### 1. .gitignore ì„¤ì •

```gitignore
# í™˜ê²½ë³€ìˆ˜ íŒŒì¼
.env.local
.env.production
.env

# ì˜ˆì™¸: í…œí”Œë¦¿ì€ ì»¤ë°‹ ê°€ëŠ¥
!.env.example
```

### 2. ë¯¼ê° ì •ë³´ ë³´í˜¸

**âŒ ì ˆëŒ€ Gitì— ì»¤ë°‹í•˜ì§€ ë§ ê²ƒ:**
- API í‚¤
- Secret í‚¤
- Private í‚¤
- ë¹„ë°€ë²ˆí˜¸

**âœ… ì•ˆì „í•œ ê´€ë¦¬:**
- ë¡œì»¬ì—ë§Œ ë³´ê´€
- ì„œë²„ì— ì§ì ‘ ìƒì„±
- íŒ€ì›ê³¼ ê³µìœ  ì‹œ ì•”í˜¸í™” ì±„ë„ ì‚¬ìš©

---

## ğŸ”„ í™˜ê²½ë³€ìˆ˜ ì—…ë°ì´íŠ¸

### ë¡œì»¬ (.env.local)

```bash
# ë¡œì»¬ íŒŒì¼ ì§ì ‘ ìˆ˜ì •
nano web/.env.local

# ë˜ëŠ”
code web/.env.local
```

ë³€ê²½ í›„ ê°œë°œ ì„œë²„ ì¬ì‹œì‘:
```bash
# ê°œë°œ ì„œë²„ ì¤‘ì§€ í›„ ì¬ì‹œì‘
npm run dev
```

---

### ì„œë²„ (.env.production)

**ë°©ë²• 1: ì„œë²„ì—ì„œ ì§ì ‘ ìˆ˜ì •**
```bash
# ì„œë²„ ì¸¡ Claudeì—ê²Œ ìš”ì²­
nano /home/insuk/blog/.env.production

# ë³€ê²½ í›„ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker stop coupang-blog && docker rm coupang-blog
docker run -d --name coupang-blog --restart always -p 3000:3000 --env-file .env.production blog-coupang-blog
```

**ë°©ë²• 2: ë¡œì»¬ì—ì„œ ì „ì†¡**
```bash
# ì£¼ì˜: ë¯¼ê° ì •ë³´ í¬í•¨ë˜ë¯€ë¡œ ì‹ ì¤‘í•˜ê²Œ
scp web/.env.production insuk@192.168.0.5:/home/insuk/blog/
```

---

### Functions (.env)

```bash
# ë¡œì»¬ì—ì„œ ìˆ˜ì •
nano functions/.env

# Firebaseì— í™˜ê²½ë³€ìˆ˜ ì„¤ì • (ë³´ì•ˆ ê¶Œì¥)
firebase functions:config:set \
  coupang.access_key="..." \
  coupang.secret_key="..." \
  openai.api_key="..." \
  gemini.api_key="..."

# ì„¤ì • í™•ì¸
firebase functions:config:get

# Functions ì¬ë°°í¬
firebase deploy --only functions
```

---

## ğŸ§ª í™˜ê²½ë³€ìˆ˜ í™•ì¸

### ë¡œì»¬ í™•ì¸

```bash
# Next.js ë¹Œë“œ ì‹œ í™˜ê²½ë³€ìˆ˜ í™•ì¸
npm run build

# íŠ¹ì • ë³€ìˆ˜ ì¶œë ¥
node -e "console.log(process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID)"
```

### ì„œë²„ í™•ì¸

```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í™˜ê²½ë³€ìˆ˜ í™•ì¸
docker exec coupang-blog env | grep NEXT_PUBLIC

# íŠ¹ì • ë³€ìˆ˜ í™•ì¸
docker exec coupang-blog env | grep FIREBASE_ADMIN_PROJECT_ID
```

### Functions í™•ì¸

```bash
# Firebase Functions í™˜ê²½ë³€ìˆ˜ í™•ì¸
firebase functions:config:get
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. NEXT_PUBLIC_ ì ‘ë‘ì‚¬

**ë°˜ë“œì‹œ í•„ìš”í•œ ê²½ìš°:**
- ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ê·¼í•´ì•¼ í•˜ëŠ” ë³€ìˆ˜

**ì˜ˆì‹œ:**
```typescript
// âœ… í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©
const projectId = process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID;

// âŒ ì„œë²„ ì „ìš© (NEXT_PUBLIC_ ì—†ìŒ)
const adminKey = process.env.FIREBASE_ADMIN_PRIVATE_KEY;
```

### 2. Private Key í˜•ì‹

**ì˜¬ë°”ë¥¸ í˜•ì‹:**
```env
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvgIB...\n-----END PRIVATE KEY-----\n"
```

**ì˜ëª»ëœ í˜•ì‹:**
```env
# âŒ ë”°ì˜´í‘œ ì—†ìŒ
FIREBASE_ADMIN_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----...

# âŒ ì‹¤ì œ ì¤„ë°”ê¿ˆ ì‚¬ìš©
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
MIIEvgIB...
-----END PRIVATE KEY-----"
```

### 3. NODE_ENV ìë™ ì„¤ì •

**ì£¼ì˜:**
- Dockerì—ì„œ `ENV NODE_ENV=production` ì„¤ì •ë¨
- .env.productionì˜ NODE_ENVë³´ë‹¤ ìš°ì„ ìˆœìœ„ ë†’ìŒ
- ë³€ê²½í•˜ë ¤ë©´ Dockerfile ìˆ˜ì • í•„ìš”

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìƒˆ í”„ë¡œì íŠ¸ ì„¤ì • ì‹œ

- [ ] web/.env.local ìƒì„± (.env.example ì°¸ê³ )
- [ ] web/.env.production ìƒì„±
- [ ] functions/.env ìƒì„±
- [ ] Firebase Admin SDK í‚¤ ìƒì„± ë° ì„¤ì •
- [ ] Coupang API í‚¤ ë°œê¸‰ ë° ì„¤ì •
- [ ] AI API í‚¤ ë°œê¸‰ ë° ì„¤ì •
- [ ] .gitignore í™•ì¸ (.env íŒŒì¼ ì œì™¸)

### ë°°í¬ ì „

- [ ] .env.production ì„œë²„ì— ì¡´ì¬
- [ ] ADMIN_GUARD_BYPASS=false í™•ì¸
- [ ] NODE_ENV=production í™•ì¸
- [ ] Firebase Admin í‚¤ ìœ íš¨ì„± í™•ì¸
- [ ] NEXT_PUBLIC_SITE_URL ì •í™•í•œ ë„ë©”ì¸ í™•ì¸

---

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### "Firebase ì´ˆê¸°í™” ì‹¤íŒ¨"

**ì›ì¸:**
- NEXT_PUBLIC_FIREBASE_* ëˆ„ë½

**í•´ê²°:**
```bash
# í™˜ê²½ë³€ìˆ˜ í™•ì¸
docker exec coupang-blog env | grep NEXT_PUBLIC_FIREBASE

# ì—†ë‹¤ë©´ .env.production í™•ì¸ í›„ ì¬ë°°í¬
```

---

### "idTokenì´ í•„ìš”í•©ë‹ˆë‹¤"

**ì›ì¸:**
- Firebase Admin SDK í‚¤ ì—†ìŒ
- ë˜ëŠ” ì˜ëª»ëœ í˜•ì‹

**í•´ê²°:**
```bash
# í‚¤ í™•ì¸
docker exec coupang-blog env | grep FIREBASE_ADMIN_PRIVATE_KEY

# í˜•ì‹ í™•ì¸ (ë”°ì˜´í‘œ, \n)
```

---

### "Coupang API ì‹¤íŒ¨"

**ì›ì¸:**
- Functions í™˜ê²½ë³€ìˆ˜ ë¯¸ì„¤ì •

**í•´ê²°:**
```bash
# Firebase Functions í™˜ê²½ë³€ìˆ˜ í™•ì¸
firebase functions:config:get

# ì„¤ì •
firebase functions:config:set coupang.access_key="..."
firebase deploy --only functions
```

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:** 2026-02-03
