# 설치형 + 관리형 사업화 계획서 (초안)

작성일: 2026-02-25  
기준 프로젝트: `coupang_auto_blog`  
참고 작업내역: `docs/작업보고서_2026-02-25.md`

---

## 1. 목표

현재 운영 중인 쿠팡 파트너스 자동화 블로그 시스템을 다음 순서로 사업화한다.

1. 설치형(초기 구축비)
2. 관리형(월 운영/유지관리)
3. 추후 구독형(SaaS) 확장

핵심 목표는 `빠른 수익화 + 운영 검증 + 향후 SaaS 전환 준비`다.

---

## 2. 사업화 전략 (결론)

### 2.1 왜 설치형 + 관리형 먼저인가

- 현재 시스템은 단일 인스턴스 운영 구조에 적합함
- 자동 수집/자동 리뷰 생성/검수/운영 UI가 이미 구현되어 있음
- SaaS(구독형)로 바로 가려면 멀티테넌트/결제/과금/권한 분리가 추가로 필요함
- 설치형은 현재 코드베이스 기반으로 빠르게 제공 가능함

### 2.2 단계별 전략

#### Phase A. 설치형 판매
- 고객 서버에 구축
- 환경설정/키 세팅/초기 자동화 설정
- 운영자 교육 + 문서 제공

#### Phase B. 관리형 운영
- 월간 유지보수/배포/장애 대응/설정 튜닝
- 고객별 서버 분리 운영(권장)

#### Phase C. 구독형 확장
- 멀티테넌트 아키텍처 설계
- 결제/플랜/사용량 제한 도입
- SaaS 전용 운영환경 구축

---

## 3. 현재 시스템 상태 평가 (판매 가능성 관점)

### 3.1 현재 구현 강점 (이미 판매 가치 있음)

- 자동 상품 수집 (골드박스/카테고리/키워드/쿠팡 PL)
- AI 리뷰 초안 생성 파이프라인
- 관리자 검수/게시 워크플로
- 이미지 수집/생성 옵션
- 로그 뷰어/운영 설정 UI
- 크론 기반 자동화 + 설정 연동 + 동적 스케줄 재적용
- Docker Compose 기반 배포 구조

### 3.2 최근 검증 완료 항목 (운영 안정성)

- 자동 수집 실행 확인
- 자동 리뷰 생성 실행 확인
- 설정 기반 크론 시간 반영 확인
- 재시작 없이 크론 시간 변경 반영 확인 (schedule sync)

### 3.3 현재 서버(레퍼런스 서버) 스펙 평가

기준 확인값:
- CPU: 2 vCPU
- RAM: 3.8GB
- Disk: 227GB 중 190GB 여유
- 동시 운영 중: `n8n`, `n8n-postgres`

판정:
- 설치형 1개 운영/검증: 가능
- 관리형 소수 고객 테스트: 조건부 가능
- 구독형 다중 고객 SaaS: 부족 (RAM/CPU)

해석:
- 현 서버는 `레퍼런스/데모/자사 운영 검증용`으로 충분
- 고객 운영은 고객별 서버 분리 전략이 적합

---

## 4. 설치형 전환 기술 검토 (ENV만으로 가능한가?)

## 4.1 결론

- `대부분은 ENV로 가능`
- `완전한 설치형 납품`을 위해서는 몇 가지 코드 정리가 필요

### 4.2 ENV 기반으로 이미 가능한 영역

- DB 연결 (`DATABASE_URL`)
- MinIO 연결 (`MINIO_*`)
- JWT/인증 (`JWT_SECRET`)
- OpenAI/AI 키 (`OPENAI_API_KEY` 등)
- 쿠팡 API 키 (`COUPANG_*`)
- Slack 알림 (`SLACK_*`)
- Web → Automation Server 내부 통신 (`AUTOMATION_SERVER_URL`)

### 4.3 설치형 전환 전 필수 보완 (중요)

#### A. 도메인 하드코딩 제거 (필수)
현재 `semolink.store` 하드코딩이 남아 있음.

영향:
- sitemap
- robots
- canonical URL
- OpenGraph URL
- metadataBase

리스크:
- 고객 도메인 설치 시 SEO 메타가 기존 도메인으로 찍힘

조치:
- `NEXT_PUBLIC_SITE_URL` 기반으로 통일

#### B. ENV/설정 파일 정리 (필수)
- `automation-server/.env.example`, `web/.env.example`, `web/.env.production` 항목 정리
- 고객 입력값/기본값/선택값 구분
- 실제 고객 비밀값은 예시 파일에 포함하지 않음 (실서버 `.env` 직접 전달/암호화 보관)
- 문서/지원 과정에서도 API 키/JWT 비밀값 평문 공유 금지

#### C. 초기 설치 프로세스 명확화 (필수)
- 관리자 계정 생성 방법
- 첫 로그인/설정/자동화 ON 절차
- SSL/도메인 연결 절차 문서화

### 4.4 고객별 차이 처리 원칙 (중요)

설치형/관리형 운영에서 가장 중요한 원칙은 `고객별 코드 분기 최소화`다.

원칙:
- 공통 코드는 동일 버전 유지
- 고객별 차이는 `ENV + DB 설정`으로 처리
- 고객별 맞춤 요구도 가능하면 코드 수정이 아니라 설정 확장으로 해결

금지/비권장:
- 고객 A 전용 코드, 고객 B 전용 코드 분기 유지
- 서버마다 수동 패치 누적
- 문서 없는 임시 수정

이 원칙을 지키지 않으면 관리형 운영 비용이 급격히 증가한다.

### 4.5 비필수(권장) 보완

- `docker-compose.yml`의 `version` 경고 제거
- schema init 로그 중복 정리
- 헬스체크/백업 스크립트 표준화

---

## 5. 상품 정의 (설치형 + 관리형)

## 5.1 설치형 상품 (1회 구축)

### 제공 범위
- 서버 설치 및 Docker 배포
- 도메인 연결 (고객 제공 도메인 기준)
- HTTPS 설정 (리버스 프록시 포함 시)
- 쿠팡 API / AI API / Slack 설정
- 자동 수집/자동 리뷰 생성 기본 설정
- 관리자 계정 세팅
- 운영자 교육 (1회)
- 설치/운영 가이드 전달

### 산출물
- 실행 가능한 시스템
- `.env` 설정 파일 템플릿
- 배포 명령/복구 명령 문서
- 운영 체크리스트

### 제외 범위 (초기 명확화 필요)
- 쿠팡 API 계정 발급 대행
- OpenAI 사용료
- 도메인/서버 비용
- SEO 성과 보장
- 정책 위반 대응 책임 전가 금지
- 법률 자문/법적 책임 대행

### 법적/정책 문서 범위 (사전 합의 필요)
- 기본 템플릿 제공 여부: 이용약관, 개인정보처리방침, 제휴/광고 고지 문구
- 고객 맞춤 작성/검토 여부: 별도 비용 또는 제외 범위
- 쿠팡 파트너스 운영 정책 준수 책임 주체 명시 (고객 우선, 관리형은 기술 지원 범위)

## 5.2 관리형 상품 (월 운영)

### 기본 관리 항목
- 정기 점검 (서비스 상태/로그/용량)
- 배포/업데이트 적용
- 장애 대응 (정해진 시간 내)
- 자동화 설정 튜닝
- 프롬프트/생성 정책 조정
- 백업 점검

### 선택 관리 항목
- 콘텐츠 품질 튜닝
- 카테고리/키워드 전략 세팅
- Slack 알림 운영
- 월간 운영 리포트

### 운영 모델 권장
- 고객별 서버 분리 (강력 권장)
- 고객별 키/데이터/로그 분리
- 동일 서버 다중 고객 수용은 초기에는 비권장

### 업데이트 운영 원칙 (관리형 핵심)

설치형은 고객 서버가 분리되므로 배포는 고객별로 개별 수행된다.  
하지만 코드는 공통 버전으로 관리해야 한다.

권장 방식:
1. 공통 저장소에서 기능 개발/테스트
2. 릴리즈 태그 발행 (예: `v1.2.0`)
3. 고객별 서버에 동일 태그/커밋 배포
4. 고객별 검증 체크리스트 수행
5. 고객별 차이는 `ENV + 설정값(DB)`만 유지

권장 운영 정책:
- 릴리즈 노트 작성
- 긴급 패치 버전 분리 (`v1.2.1-hotfix`)
- 고객별 현재 버전 기록
- 커스터마이징 요청은 먼저 “설정화 가능 여부” 검토

### 다수 인스턴스 업데이트 표준화 (권장)

고객 수가 늘어나면 수동 배포 반복은 실수 가능성이 높아진다.

1차 권장:
- 고객 서버별 `update-instance.sh` 스크립트 표준화
- 공통 명령(백업/풀/빌드/재기동/로그 확인) 순서 고정

2차 검토:
- SSH/Webhook 기반 원격 업데이트 트리거
- 중앙 관리 허브(관리형 운영 전용) 도입 검토

### 롤백 운영 원칙 (관리형 필수)

배포 실패 가능성을 전제로 롤백 절차를 표준화한다.

배포 전:
- DB 백업 수행 여부 확인
- 현재 운영 버전/커밋 기록
- 변경 범위와 영향 기능 확인

롤백 트리거 예시:
- 관리자 로그인 불가
- `/admin` 주요 기능 오류 (수집/후기 승인/설정 저장 실패)
- 공개 페이지 5xx 증가
- 크론 초기화 실패/반복 오류

롤백 절차(표준):
1. 이전 안정 버전 태그/커밋으로 복귀
2. `docker compose build && up -d` 재기동
3. 핵심 기능 점검 (`/admin`, 공개 페이지, 크론 초기화 로그)
4. 고객 공지 및 원인 분석 예약

---

## 6. 고객 온보딩 표준 절차 (설치형)

## 6.1 사전 준비 (고객 준비물)

- 서버 접속 정보 (SSH)
- 도메인/서브도메인
- 쿠팡 파트너스 API 키
- OpenAI API 키 (필수)
- Slack Webhook (선택)

## 6.2 설치 절차 (표준)

1. 서버 기본 패키지/도커 설치
2. 도메인/DNS 연결 확인
3. 리버스 프록시 및 HTTPS(SSL) 설정
4. 프로젝트 배포 (`git clone` 또는 전달 패키지)
5. ENV 파일 설정
6. `docker compose build && up -d`
7. 외부 접속 점검 (도메인, HTTPS, 메인 페이지)
8. 관리자 로그인 확인 (`/admin`)
9. 설정값 입력 (쿠팡/API/자동화/이미지)
10. 수동 수집/리뷰 생성 테스트
11. 자동 수집/자동 리뷰 생성 크론 테스트
12. 운영자 교육

## 6.3 인수인계 체크리스트

- 관리자 로그인/로그아웃
- 쿠팡 API 연결 테스트
- 상품 수집 수동 실행
- 자동 리뷰 생성 동작 확인
- 리뷰 검수/게시 흐름 확인
- 로그 뷰어 확인
- 사이트 브랜딩 확인 (사이트명/로고/푸터)
- 파비콘 표시 확인 (브라우저 탭)
- OG/메타 기본값 확인 (공유 미리보기/페이지 소스)
- 백업/복구 절차 안내

---

## 6A. 사이트 정보/브랜딩 설정 정책 (설치형 필수 설계)

설치형 고객은 사이트 이름, 도메인, 푸터 문구 등이 서로 다르므로 `브랜딩 정보`를 표준화된 설정으로 관리해야 한다.

### 6A.1 왜 필요한가

- 고객별 사이트명/푸터/연락처가 다름
- 도메인이 다름 (SEO/캐노니컬/사이트맵 영향)
- 코드 수정 없이 고객이 변경할 수 있어야 관리형 운영 비용 절감

### 6A.2 처리 원칙 (중요)

#### A. 도메인/SEO 기준 URL
- 우선 `ENV`로 관리 (`NEXT_PUBLIC_SITE_URL`)
- 이유:
  - sitemap/robots/metadata/canonical 등 빌드/런타임 공통 기준 URL에 사용
  - 설치 시 명시적으로 확정해야 함

#### B. 브랜딩/표시용 정보
- `DB 설정(settings.system.site)`로 관리
- 이유:
  - 고객이 관리자에서 직접 변경 가능
  - 코드 배포 없이 수정 가능

### 6A.3 권장 사이트 정보 스키마 (초안)

`settings.system.site`

```json
{
  "site": {
    "name": "사이트명",
    "tagline": "사이트 한줄 소개",
    "footerCopyright": "© 2026 사이트명. All rights reserved.",
    "logoUrl": "/logo.png",
    "faviconUrl": "/favicon.ico",
    "appleTouchIconUrl": "/apple-touch-icon.png",
    "ogDefaultImageUrl": "https://example.com/og-default.png",
    "contactEmail": "admin@example.com",
    "businessName": "",
    "homepageTitle": "",
    "homepageDescription": "",
    "defaultMetaTitle": "",
    "defaultMetaDescription": "",
    "affiliateDisclosureText": "이 포스트는 쿠팡 파트너스 활동의 일환으로 일정 수수료를 받을 수 있습니다."
  }
}
```

### 6A.4 적용 대상 (우선순위)

1차 적용 (필수):
- 헤더 로고/사이트명
- 푸터 카피라이트
- 기본 메타 title/description
- 파비콘 / 아이콘 메타 (`icon`, `shortcut`, `apple`)

2차 적용 (권장):
- OG 기본값
- 연락처/문의 정보
- 운영자 소개/회사명
- 제휴/광고 고지 기본 문구

3차 적용 (추후):
- 다중 로고(라이트/다크)
- 브랜드 컬러/테마 설정
- OG 템플릿 커스터마이징

### 6A.5 설치형 운영 관점의 효과

- 고객별 브랜딩 변경 시 코드 수정 불필요
- 관리형 월 운영 시 대응 시간 단축
- 향후 구독형(SaaS) 확장 시 동일 구조 재사용 가능

---

## 7. 운영/보안 기준 (관리형 필수)

## 7.1 보안 최소 기준

- 관리자 경로 공개 메뉴 비노출
- `/admin` 로그인 진입 + 인증 필수
- `/api/admin/*` 인증 필수
- 로그인 시도 제한 (반영됨)
- 강한 `JWT_SECRET`
- HTTPS 적용
- 관리자 비밀번호 정책

## 7.2 운영 모니터링 기준

- 컨테이너 상태 (`docker compose ps`)
- 크론 실행 로그
- 수집/생성 실패율
- 디스크 사용량 (특히 MinIO)
- DB 용량 증가
- 중앙 상태 보고(텔레메트리) 여부 확인 (`HEALTH_CHECK_URL` 또는 Slack heartbeat)

### 텔레메트리 확장 (권장)

관리형 서비스는 고객 문의 전에 장애를 감지하는 것이 중요하다.

권장 방향:
- `HEALTH_CHECK_URL` 환경 변수 추가 검토
- 자동화 서버가 주기적으로 상태를 보고(heartbeat)
- 실패 시 Slack/중앙 알림으로 통합

## 7.3 백업/복구 기준

필수 백업 대상:
- PostgreSQL 데이터
- MinIO 오브젝트(이미지)
- ENV 파일 (암호화 보관 권장)

백업 책임/저장 위치 원칙:
- 설치형: 고객 지정 저장소(로컬/S3/MinIO 등)로 백업 스크립트 제공
- 관리형: 서버와 분리된 외부 저장소에 백업 권장 (소유권/접근권한 사전 합의)
- 백업 소유권과 복구 요청 절차를 계약/운영 문서에 명시

복구 테스트 항목:
- 신규 서버 복원 후 로그인 가능 여부
- 게시된 리뷰 페이지 정상 노출
- 자동화 크론 정상 동작 여부

---

## 8. 가격 정책 초안 (예시, 추후 확정)

## 8.1 설치형 (1회)

- 기본 설치형: 서버 1대, 단일 사이트, 기본 자동화 설정
- 고급 설치형: 추가 튜닝/이미지 설정/운영 리포트 셋업 포함

## 8.2 관리형 (월)

- Lite: 장애 대응 + 배포 + 기본 점검
- Standard: 튜닝/로그 모니터링/월간 리포트 포함
- Premium: 운영 대행 수준 (정책/키워드/자동화 설정 최적화 포함)

※ 실제 금액은 고객군/지원 시간/운영 범위 기준으로 별도 산정

---

## 9. 개발 로드맵 (사업화 준비용)

## 9.1 1차 (판매 준비 필수)

### 기술
- [ ] 도메인 하드코딩 제거 (`NEXT_PUBLIC_SITE_URL` 통일)
- [ ] 사이트 정보 설정 스키마 추가 (`settings.system.site`)
- [ ] 관리자 설정에 `사이트 정보` 섹션 추가 (사이트명/로고/파비콘/푸터/연락처 등)
- [ ] 헤더/푸터/기본 메타를 사이트 정보 설정과 연동
- [ ] 파비콘/아이콘 메타(`icon`, `shortcut`, `apple`) 설정 연동
- [ ] OG 기본 이미지/메타 기본값 설정 연동
- [ ] ENV 템플릿 정리 (`web`, `automation-server`)
- [ ] 설치 문서/배포 문서 표준화
- [ ] 백업/복구 가이드 문서화

### 운영
- [ ] 설치 체크리스트 문서
- [ ] 인수인계 문서
- [ ] 관리형 점검 체크리스트
- [ ] 배포/롤백 체크리스트 문서

## 9.2 2차 (관리형 품질 강화)

- [ ] 운영 로그/에러 알림 표준화
- [ ] `HEALTH_CHECK_URL` 기반 heartbeat/중앙 상태 보고 설계
- [ ] 서버 점검 스크립트
- [ ] 업데이트 릴리즈 절차
- [ ] `update-instance.sh` 표준 스크립트 작성
- [ ] 고객별 설정/버전 관리 정책
- [ ] 관리자 UI 버전 정보 표시 (지원 대응용)

## 9.3 3차 (구독형 준비)

- [ ] 테넌트 분리 전략 설계 (`tenant_id`)
- [ ] 사용량 집계 설계 (수집/생성/저장량)
- [ ] 플랜/권한/과금 모델 설계
- [ ] 결제 연동 검토
- [ ] `LICENSE_KEY`(중기) 검토 및 적용 기준 정의

---

## 10. 리스크 및 대응

## 10.1 기술 리스크

- 도메인 하드코딩 누락으로 잘못된 SEO 메타 노출
  - 대응: 도메인 설정 점검 스크립트/체크리스트

- 서버 자원 부족(RAM)으로 피크 시 지연
  - 대응: 고객별 서버 분리, 권장 스펙 명시

- 외부 API 제한/변경 (쿠팡/OpenAI)
  - 대응: 설정값 조정, 수집/생성 제한 옵션 활용

## 10.2 운영 리스크

- 고객이 API 키/설정 잘못 입력
  - 대응: 연결 테스트/가이드 강화

- 자동화 과다 실행으로 비용 증가
  - 대응: maxPerRun, draft backlog, 시간 설정 가이드 제공

- 고객별 커스터마이징 누적으로 운영 복잡도 증가
  - 대응: 설정 기반 우선 원칙, 예외 커스터마이징 승인 기준 수립

- 다수 고객 업데이트 시 수동 배포 실수
  - 대응: `update-instance.sh` 표준화, 릴리즈/롤백 절차 고정

## 10.3 사업 리스크

- 설치 후 운영 미숙으로 “제품 문제”로 인식될 수 있음
  - 대응: 관리형 옵션 제공 + 운영 교육 강화

---

## 11. 의사결정 항목 (확정 필요)

아래는 계획서 확정 전에 결정해야 하는 항목:

1. 설치형 기본 범위(어디까지 포함할지)
2. 관리형 월 지원 범위/응답시간
3. 고객 서버 최소 권장 스펙
4. 가격 정책 초안
5. 백업 책임 범위 (고객/관리형)
6. 향후 구독형 전환 목표 시점
7. 사이트 정보 설정 범위 (1차: 이름/푸터/연락처까지 vs 메타/브랜드까지)
8. 고객별 커스터마이징 허용 정책 (설정 기반만 허용 여부)
9. 법적/정책 문서 제공 범위 (템플릿 제공 vs 제외)
10. 롤백 기준/장애 공지 운영 수준
11. 관리형 백업 저장 위치/소유권 정책
12. 텔레메트리 도입 수준 (`HEALTH_CHECK_URL`, Slack heartbeat 등)
13. 라이선스 키(`LICENSE_KEY`) 도입 시점 (중기/후기)

---

## 12. 다음 실행 순서 (바로 진행)

1. 도메인 하드코딩 제거 작업 (`NEXT_PUBLIC_SITE_URL` 통일)
2. 사이트 정보 설정 설계 (`settings.system.site`) 확정
3. 브랜딩 자산 범위 확정 (로고/파비콘/OG 이미지/푸터/고지문구)
4. 설치형 필수 ENV 목록 정리 문서 작성
5. 설치형 배포/운영/롤백 체크리스트 문서 작성
6. 관리형 표준 업데이트 스크립트(`update-instance.sh`) 초안 작성
7. 가격/범위 초안 확정
8. 설치형 첫 고객 대상 제안서 버전 작성
