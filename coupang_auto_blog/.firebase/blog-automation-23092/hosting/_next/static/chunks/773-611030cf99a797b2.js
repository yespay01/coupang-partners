"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{2498:(e,t,a)=>{a.d(t,{D:()=>l,R:()=>u});var n=a(5155),s=a(2115),i=a(3885),o=a(8789);let r=(0,s.createContext)(void 0);function u(e){let{children:t}=e,a=function(){let[e,t]=(0,s.useState)({status:"initializing",user:null,error:null});return(0,s.useEffect)(()=>{let e,a=!0;return async function(){try{let{app:n}=await (0,o.w)(),s=(0,i.xI)(n);e=(0,i.hg)(s,e=>{a&&t({status:"ready",user:e,error:null})})}catch(e){if(!a)return;t({status:"error",user:null,error:e instanceof Error?e:Error("Firebase 초기화 실패")})}}(),()=>{a=!1,e&&e()}},[]),e}(),u=(0,s.useMemo)(()=>a,[a]);return(0,n.jsx)(r.Provider,{value:u,children:t})}function l(){let e=(0,s.useContext)(r);if(!e)throw Error("useFirebase는 FirebaseProvider 내부에서만 사용할 수 있습니다.");return e}},3820:(e,t,a)=>{a.d(t,{C:()=>i});var n=a(5959),s=a(9064);let i=(0,n.v)(e=>({settings:s.a$,isLoading:!0,isSaving:!1,error:null,activeTab:"automation",hasUnsavedChanges:!1,setSettings:t=>e({settings:t,hasUnsavedChanges:!1}),setLoading:t=>e({isLoading:t}),setSaving:t=>e({isSaving:t}),setError:t=>e({error:t}),setActiveTab:t=>e({activeTab:t}),setHasUnsavedChanges:t=>e({hasUnsavedChanges:t}),setAutomationEnabled:t=>e(e=>({settings:{...e.settings,automation:{...e.settings.automation,enabled:t}},hasUnsavedChanges:!0})),setCollectSchedule:t=>e(e=>({settings:{...e.settings,automation:{...e.settings.automation,collectSchedule:t}},hasUnsavedChanges:!0})),setMaxProductsPerRun:t=>e(e=>({settings:{...e.settings,automation:{...e.settings.automation,maxProductsPerRun:t}},hasUnsavedChanges:!0})),setCategories:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,categories:t}},hasUnsavedChanges:!0})),toggleCategory:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,categories:e.settings.topics.categories.map(e=>e.id===t?{...e,enabled:!e.enabled}:e)}},hasUnsavedChanges:!0})),setKeywords:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,keywords:t}},hasUnsavedChanges:!0})),addKeyword:t=>e(e=>{let a=t.trim();return!a||e.settings.topics.keywords.includes(a)?e:{settings:{...e.settings,topics:{...e.settings.topics,keywords:[...e.settings.topics.keywords,a]}},hasUnsavedChanges:!0}}),removeKeyword:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,keywords:e.settings.topics.keywords.filter(e=>e!==t)}},hasUnsavedChanges:!0})),setGoldboxEnabled:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,goldboxEnabled:t}},hasUnsavedChanges:!0})),setCoupangPLBrands:t=>e(e=>({settings:{...e.settings,topics:{...e.settings.topics,coupangPLBrands:t}},hasUnsavedChanges:!0})),toggleCoupangPLBrand:t=>e(e=>{let a=e.settings.topics.coupangPLBrands||[],n=a.includes(t)?a.filter(e=>e!==t):[...a,t];return{settings:{...e.settings,topics:{...e.settings.topics,coupangPLBrands:n}},hasUnsavedChanges:!0}}),setDefaultProvider:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,defaultProvider:t}},hasUnsavedChanges:!0})),setOpenAIApiKey:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,openai:{...e.settings.ai.openai,apiKey:t}}},hasUnsavedChanges:!0})),setOpenAIModel:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,openai:{...e.settings.ai.openai,model:t}}},hasUnsavedChanges:!0})),setAnthropicApiKey:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,anthropic:{...e.settings.ai.anthropic,apiKey:t}}},hasUnsavedChanges:!0})),setAnthropicModel:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,anthropic:{...e.settings.ai.anthropic,model:t}}},hasUnsavedChanges:!0})),setGoogleApiKey:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,google:{...e.settings.ai.google,apiKey:t}}},hasUnsavedChanges:!0})),setGoogleModel:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,google:{...e.settings.ai.google,model:t}}},hasUnsavedChanges:!0})),setTemperature:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,temperature:t}},hasUnsavedChanges:!0})),setMaxTokens:t=>e(e=>({settings:{...e.settings,ai:{...e.settings.ai,maxTokens:t}},hasUnsavedChanges:!0})),setSystemPrompt:t=>e(e=>({settings:{...e.settings,prompt:{...e.settings.prompt,systemPrompt:t}},hasUnsavedChanges:!0})),setReviewTemplate:t=>e(e=>({settings:{...e.settings,prompt:{...e.settings.prompt,reviewTemplate:t}},hasUnsavedChanges:!0})),setMinLength:t=>e(e=>({settings:{...e.settings,prompt:{...e.settings.prompt,minLength:t}},hasUnsavedChanges:!0})),setMaxLength:t=>e(e=>({settings:{...e.settings,prompt:{...e.settings.prompt,maxLength:t}},hasUnsavedChanges:!0})),setToneScoreThreshold:t=>e(e=>({settings:{...e.settings,prompt:{...e.settings.prompt,toneScoreThreshold:t}},hasUnsavedChanges:!0})),setCoupangEnabled:t=>e(e=>({settings:{...e.settings,coupang:{...e.settings.coupang,enabled:t}},hasUnsavedChanges:!0})),setCoupangAccessKey:t=>e(e=>({settings:{...e.settings,coupang:{...e.settings.coupang,accessKey:t}},hasUnsavedChanges:!0})),setCoupangSecretKey:t=>e(e=>({settings:{...e.settings,coupang:{...e.settings.coupang,secretKey:t}},hasUnsavedChanges:!0})),setCoupangPartnerId:t=>e(e=>({settings:{...e.settings,coupang:{...e.settings.coupang,partnerId:t}},hasUnsavedChanges:!0})),setCoupangSubId:t=>e(e=>({settings:{...e.settings,coupang:{...e.settings.coupang,subId:t}},hasUnsavedChanges:!0})),resetToDefaults:()=>e({settings:s.a$,hasUnsavedChanges:!0})}))},6436:(e,t,a)=>{a.d(t,{EZ:()=>p,Gm:()=>f,Lf:()=>r,RV:()=>h,WD:()=>c,bx:()=>m,e_:()=>o,hc:()=>d,st:()=>g,xN:()=>l});var n=a(9708),s=a(8789);let i=null;async function o(e){var t,a;let{limit:s,startAfterDoc:i,levels:o,createdAfter:u}=e,l=await r(),d=[(0,n.My)("createdAt","desc"),(0,n.AB)(s+1)],c=null==o?void 0:o.filter(Boolean);c&&c.length&&c.length<3&&d.push((0,n._M)("level","in",c)),u&&d.push((0,n._M)("createdAt",">=",u)),i&&d.push((0,n.HM)(i));let p=await (0,n.GG)((0,n.P)((0,n.rJ)(l,"logs"),...d)),h=p.docs.slice(0,s),m=p.docs.length>s,f=await (0,n.d_)((0,n.rJ)(l,"logs"));return{documents:h.map(e=>{var t,a,n;let s=e.data();return{id:e.id,level:s.level,message:null!=(t=s.message)?t:s.type,type:s.type,createdAt:g(s.createdAt),context:null!=(n=s.context)?n:JSON.stringify(null!=(a=s.payload)?a:{}),payload:s.payload}}),firstSnapshot:null!=(t=h[0])?t:null,lastSnapshot:null!=(a=h[h.length-1])?a:null,hasMore:m,totalCount:f.data().count}}async function r(){if(i)return i;let{app:e}=await (0,s.w)();return i=(0,n.aU)(e)}async function u(e,t){let a=await r();return(0,n.P)((0,n.rJ)(a,e),(0,n.My)("createdAt","desc"),(0,n.AB)(t))}async function l(e,t,a){try{let s=await u(e,t);return(0,n.aQ)(s,e=>{let t=e.docs.map(e=>{let t=e.data();return{id:e.id,...t}});a(t)},t=>{console.warn("[firestore] subscribe failed for ".concat(e,":"),t),a([])})}catch(t){return console.warn("[firestore] subscribe setup failed for ".concat(e,":"),t),a([]),()=>{}}}async function d(e,t){let a=await r();await (0,n.gS)((0,n.rJ)(a,e),{...t,createdAt:(0,n.O5)()})}async function c(e,t){let a=await r(),s=(0,n.H9)(a,"reviews",e);await (0,n.mZ)(s,{status:t,updatedAt:(0,n.O5)()})}function g(e){return e?"string"==typeof e?e:e instanceof Date?e.toISOString():"function"==typeof e.toDate?e.toDate().toISOString():"":""}async function p(e){var t,a;let{limit:s,startAfterDoc:i,statuses:o,updatedAfter:u}=e,l=await r(),d=[(0,n.My)("updatedAt","desc"),(0,n.AB)(s+1)],c=null==o?void 0:o.filter(Boolean);c&&c.length&&c.length<4&&d.push((0,n._M)("status","in",c)),u&&d.push((0,n._M)("updatedAt",">=",u)),i&&d.push((0,n.HM)(i));let p=await (0,n.GG)((0,n.P)((0,n.rJ)(l,"reviews"),...d)),h=p.docs.slice(0,s),m=p.docs.length>s,f=await (0,n.d_)((0,n.rJ)(l,"reviews"));return{documents:h.map(e=>{var t;let a=e.data();return{id:e.id,productId:a.productId,productName:a.productName,author:a.author,status:a.status,updatedAt:g(null!=(t=a.updatedAt)?t:a.createdAt),createdAt:g(a.createdAt),content:a.content,toneScore:a.toneScore,charCount:a.charCount}}),firstSnapshot:null!=(t=h[0])?t:null,lastSnapshot:null!=(a=h[h.length-1])?a:null,hasMore:m,totalCount:f.data().count}}async function h(e){var t;let a=await r(),s=(0,n.H9)(a,"reviews",e),i=await (0,n.x7)(s);if(!i.exists())return null;let o=i.data();return{id:i.id,productId:o.productId,productName:o.productName,author:o.author,status:o.status,updatedAt:g(null!=(t=o.updatedAt)?t:o.createdAt),createdAt:g(o.createdAt),content:o.content,toneScore:o.toneScore,charCount:o.charCount,category:o.category,affiliateUrl:o.affiliateUrl,media:o.media}}async function m(e){var t,a,s,i,o;let u=await r();return(await (0,n.gS)((0,n.rJ)(u,"reviews"),{productName:e.productName,content:e.content,category:null!=(t=e.category)?t:"",affiliateUrl:null!=(a=e.affiliateUrl)?a:"",author:null!=(s=e.author)?s:"관리자",status:null!=(i=e.status)?i:"draft",media:null!=(o=e.media)?o:[],charCount:e.content.length,toneScore:.7,createdAt:(0,n.O5)(),updatedAt:(0,n.O5)()})).id}async function f(e,t){let a=await r(),s=(0,n.H9)(a,"reviews",e),i={updatedAt:(0,n.O5)()};void 0!==t.productName&&(i.productName=t.productName),void 0!==t.content&&(i.content=t.content,i.charCount=t.content.length),void 0!==t.category&&(i.category=t.category),void 0!==t.affiliateUrl&&(i.affiliateUrl=t.affiliateUrl),void 0!==t.author&&(i.author=t.author),void 0!==t.status&&(i.status=t.status),void 0!==t.media&&(i.media=t.media),await (0,n.mZ)(s,i)}},7773:(e,t,a)=>{a.d(t,{RG:()=>A,wU:()=>w,e6:()=>b});var n=a(2115),s=a(9776),i=a(2454),o=a(549),r=a(2498),u=a(9708),l=a(6436),d=a(9064);let c="system_settings",g="global";async function p(){let e=await (0,l.Lf)(),t=(0,u.H9)(e,c,g),a=await (0,u.x7)(t);return a.exists()?h(a.data()):(await m(),d.a$)}function h(e){var t,a,n,s,i,o,r,u,l,c,g,p;return{automation:{...d.a$.automation,...e.automation},topics:{...d.a$.topics,...e.topics},ai:{...d.a$.ai,openai:{...d.a$.ai.openai,...null!=(r=null==(t=e.ai)?void 0:t.openai)?r:{}},anthropic:{...d.a$.ai.anthropic,...null!=(u=null==(a=e.ai)?void 0:a.anthropic)?u:{}},google:{...d.a$.ai.google,...null!=(l=null==(n=e.ai)?void 0:n.google)?l:{}},defaultProvider:null!=(c=null==(s=e.ai)?void 0:s.defaultProvider)?c:d.a$.ai.defaultProvider,temperature:null!=(g=null==(i=e.ai)?void 0:i.temperature)?g:d.a$.ai.temperature,maxTokens:null!=(p=null==(o=e.ai)?void 0:o.maxTokens)?p:d.a$.ai.maxTokens},prompt:{...d.a$.prompt,...e.prompt},coupang:{...d.a$.coupang,...e.coupang},updatedAt:e.updatedAt,updatedBy:e.updatedBy}}async function m(){let e=await (0,l.Lf)(),t=(0,u.H9)(e,c,g);await (0,u.BN)(t,{...d.a$,updatedAt:(0,u.O5)(),updatedBy:"system"})}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"admin",a=await (0,l.Lf)(),n=(0,u.H9)(a,c,g);if(!(await (0,u.x7)(n)).exists())return void await (0,u.BN)(n,{...d.a$,...e,updatedAt:(0,u.O5)(),updatedBy:t});let s={updatedAt:(0,u.O5)(),updatedBy:t};e.automation&&Object.entries(e.automation).forEach(e=>{let[t,a]=e;s["automation.".concat(t)]=a}),e.topics&&Object.entries(e.topics).forEach(e=>{let[t,a]=e;s["topics.".concat(t)]=a}),e.ai&&(void 0!==e.ai.defaultProvider&&(s["ai.defaultProvider"]=e.ai.defaultProvider),void 0!==e.ai.temperature&&(s["ai.temperature"]=e.ai.temperature),void 0!==e.ai.maxTokens&&(s["ai.maxTokens"]=e.ai.maxTokens),e.ai.openai&&Object.entries(e.ai.openai).forEach(e=>{let[t,a]=e;s["ai.openai.".concat(t)]=a}),e.ai.anthropic&&Object.entries(e.ai.anthropic).forEach(e=>{let[t,a]=e;s["ai.anthropic.".concat(t)]=a}),e.ai.google&&Object.entries(e.ai.google).forEach(e=>{let[t,a]=e;s["ai.google.".concat(t)]=a})),e.prompt&&Object.entries(e.prompt).forEach(e=>{let[t,a]=e;s["prompt.".concat(t)]=a}),e.coupang&&Object.entries(e.coupang).forEach(e=>{let[t,a]=e;s["coupang.".concat(t)]=a}),await (0,u.mZ)(n,s)}async function v(e){let t=await (0,l.Lf)(),a=(0,u.H9)(t,c,g);return(0,u.aQ)(a,t=>{t.exists()?e(h(t.data())):e(d.a$)},t=>{console.warn("[settingsService] Subscribe error:",t),e(d.a$)})}var y=a(3820);let C=["system-settings"];function b(){let{status:e}=(0,r.D)(),t=(0,s.jE)(),{settings:a,setSettings:u,setLoading:l,setSaving:d,setError:c,isLoading:g,isSaving:h,error:m,hasUnsavedChanges:b,setHasUnsavedChanges:w}=(0,y.C)(),{data:A,isLoading:U,error:S,refetch:x}=(0,i.I)({queryKey:C,queryFn:p,enabled:"ready"===e,staleTime:3e5,gcTime:18e5});(0,n.useEffect)(()=>{A&&!b&&u(A)},[A,u,b]),(0,n.useEffect)(()=>{l(U||"ready"!==e)},[U,e,l]),(0,n.useEffect)(()=>{S&&c(S instanceof Error?S.message:"설정 로드 실패")},[S,c]),(0,n.useEffect)(()=>{let a;if("ready"===e)return(async()=>{a=await v(e=>{t.setQueryData(C,e),b||u(e)})})(),()=>{null==a||a()}},[e,t,u,b]);let P=(0,o.n)({mutationFn:e=>f(e),onMutate:()=>{d(!0),c(null)},onSuccess:()=>{w(!1),t.invalidateQueries({queryKey:C})},onError:e=>{c(e instanceof Error?e.message:"설정 저장 실패")},onSettled:()=>{d(!1)}}),k=(0,n.useCallback)(async()=>{await P.mutateAsync(a)},[P,a]),T=(0,n.useCallback)(async e=>{let t=a[e];t&&await P.mutateAsync({[e]:t})},[P,a]),E=(0,n.useCallback)(()=>{A&&u(A)},[A,u]);return{settings:a,remoteSettings:A,isLoading:g||U,isSaving:h,error:m,hasUnsavedChanges:b,saveSettings:k,saveSection:T,discardChanges:E,refetch:x}}function w(){let{settings:e}=(0,y.C)(),t=(0,n.useCallback)(()=>{let t=[],{automation:a}=e;return(a.maxProductsPerRun<1||a.maxProductsPerRun>100)&&t.push("1회 최대 수집 상품 수는 1~100 사이여야 합니다."),/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(a.collectSchedule)||t.push("수집 스케줄 형식이 올바르지 않습니다. (HH:mm)"),t},[e]),a=(0,n.useCallback)(()=>{let t=[],{ai:a}=e;return(a.temperature<0||a.temperature>2)&&t.push("Temperature는 0~2 사이여야 합니다."),(a.maxTokens<100||a.maxTokens>8192)&&t.push("Max Tokens는 100~8192 사이여야 합니다."),a[a.defaultProvider].apiKey||t.push("(권장) ".concat(a.defaultProvider," API 키가 설정되지 않았습니다.")),t},[e]),s=(0,n.useCallback)(()=>{let t=[],{prompt:a}=e;return(a.minLength<10||a.minLength>500)&&t.push("최소 글자 수는 10~500 사이여야 합니다."),(a.maxLength<a.minLength||a.maxLength>2e3)&&t.push("최대 글자 수는 최소값보다 크고 2000 이하여야 합니다."),(a.toneScoreThreshold<0||a.toneScoreThreshold>1)&&t.push("톤 점수 임계값은 0~1 사이여야 합니다."),a.systemPrompt.trim()||t.push("시스템 프롬프트를 입력해주세요."),a.reviewTemplate.trim()||t.push("리뷰 템플릿을 입력해주세요."),t},[e]),i=(0,n.useCallback)(()=>{let t=[],{coupang:a}=e;return a.enabled&&(a.accessKey||t.push("(권장) 쿠팡 Access Key를 입력해주세요."),a.secretKey||t.push("(권장) 쿠팡 Secret Key를 입력해주세요."),a.partnerId||t.push("(권장) 쿠팡 Partner ID를 입력해주세요.")),t},[e]),o=(0,n.useCallback)(()=>[...t(),...a(),...s(),...i()],[t,a,s,i]);return{validateAutomation:t,validateAI:a,validatePrompt:s,validateCoupang:i,validateAll:o}}function A(){let{settings:e}=(0,y.C)(),t=(0,o.n)({mutationFn:async()=>{let t=await fetch("/api/settings/coupang/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessKey:e.coupang.accessKey,secretKey:e.coupang.secretKey,partnerId:e.coupang.partnerId})});if(!t.ok)throw Error("연결 테스트 실패");return t.json()}});return{testConnection:t.mutate,isTestingConnection:t.isPending,testResult:t.data,testError:t.error,resetTest:t.reset}}},8789:(e,t,a)=>{a.d(t,{w:()=>o});var n=a(2078),s=a(8871);let i=null;async function o(){if(i)return i;let e=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)(function(){return{apiKey:"AIzaSyCPI1msAqKlbF83upcdEClY9xlAMhJs-3I",authDomain:"blog-automation-23092.firebaseapp.com",projectId:"blog-automation-23092",storageBucket:"blog-automation-23092.firebasestorage.app",messagingSenderId:"944342575434",appId:"1:944342575434:web:f9ee17d38296ffe0aaf9b3",measurementId:""}}()),t=null;return t=await (0,s.TT)()?(0,s.P5)(e):null,i={app:e,analytics:t}}},9064:(e,t,a)=>{a.d(t,{R_:()=>s,a$:()=>o,uZ:()=>n,yV:()=>i});let n=[{id:"1001",name:"탐사"},{id:"1002",name:"코멧"},{id:"1003",name:"Gomgom"},{id:"1004",name:"줌"},{id:"1006",name:"곰곰"},{id:"1007",name:"꼬리별"},{id:"1008",name:"베이스알파에센셜"},{id:"1010",name:"비타할로"},{id:"1011",name:"비지엔젤"}],s="당신은 전문적인 상품 리뷰 작성자입니다.\n실제 사용 경험을 바탕으로 생생하고 신뢰감 있는 리뷰를 작성해주세요.\n광고성 문구나 과장된 표현은 피하고, 솔직하고 도움이 되는 내용을 담아주세요.",i='{productName} ({category}) 상품에 대한 후기를 생생하게 작성해주세요.\n{minLength}~{maxLength}자 분량으로, 실제 사용 경험처럼 묘사하고 광고성 문구는 삼가주세요.\n예: "배송이 빨라서 원하는 날에 도착했고, 품질도 만족스러워 인테리어에도 잘 어울려요."',o={automation:{enabled:!1,collectSchedule:"02:00",maxProductsPerRun:10},topics:{categories:[{id:"1",name:"패션의류/잡화",enabled:!1},{id:"2",name:"뷰티",enabled:!1},{id:"3",name:"출산/유아동",enabled:!1},{id:"4",name:"식품",enabled:!1},{id:"5",name:"주방용품",enabled:!1},{id:"6",name:"생활용품",enabled:!1},{id:"7",name:"홈인테리어",enabled:!1},{id:"8",name:"가전디지털",enabled:!1},{id:"9",name:"스포츠/레저",enabled:!1},{id:"10",name:"자동차용품",enabled:!1},{id:"11",name:"도서/음반/DVD",enabled:!1},{id:"12",name:"완구/취미",enabled:!1},{id:"13",name:"문구/오피스",enabled:!1},{id:"14",name:"반려동물용품",enabled:!1},{id:"15",name:"헬스/건강식품",enabled:!1}],keywords:[],goldboxEnabled:!0,coupangPLBrands:[]},ai:{defaultProvider:"openai",openai:{apiKey:"",model:"gpt-4o-mini"},anthropic:{apiKey:"",model:"claude-3-5-sonnet-20241022"},google:{apiKey:"",model:"gemini-1.5-flash"},temperature:.7,maxTokens:1024},prompt:{systemPrompt:s,reviewTemplate:i,minLength:90,maxLength:170,toneScoreThreshold:.4},coupang:{enabled:!1,accessKey:"",secretKey:"",partnerId:"",subId:""}}}}]);