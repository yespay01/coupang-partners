# ì¿ íŒ¡ ìë™ ë¸”ë¡œê·¸ ì„œë²„ ë°°í¬ ê°€ì´ë“œ (Git ê¸°ë°˜)

> ìµœì¢… ì—…ë°ì´íŠ¸: 2026-02-10
> Git ì›Œí¬í”Œë¡œìš° ê¸°ë°˜ ë°°í¬

---

## ğŸ“‹ ë°°í¬ ê°œìš”

- **ë„ë©”ì¸**: semolink.store
- **ì„œë²„**: Ubuntu 20.04
- **ë°°í¬ ê²½ë¡œ**: `/home/insuk/blog`
- **í¬íŠ¸**: 3000 (ë‚´ë¶€), 443 (HTTPS)
- **SSL**: Let's Encrypt (ì´ë¯¸ ì„¤ì •ë¨)
- **ë°°í¬ ë°©ì‹**: Git Pull + Docker Build

---

## ğŸš€ Git ê¸°ë°˜ ë°°í¬ ë‹¨ê³„

### ì „ì œ ì¡°ê±´

ì„œë²„ì— í”„ë¡œì íŠ¸ê°€ Git ì €ì¥ì†Œë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•¨:

```bash
cd /home/insuk/blog

# Git ì €ì¥ì†Œ í™•ì¸
git remote -v

# ì›ê²© ì €ì¥ì†Œ ì„¤ì • (ìµœì´ˆ 1íšŒë§Œ)
git remote add origin https://github.com/yespay01/coupang-partners.git
```

---

### 1ë‹¨ê³„: Git Pull (ìµœì‹  ì½”ë“œ ë°›ê¸°)

```bash
cd /home/insuk/blog

# ì›ê²© ì €ì¥ì†Œ ìµœì‹  ì •ë³´ ê°€ì ¸ì˜¤ê¸°
git fetch

# í˜„ì¬ ë¸Œëœì¹˜ í™•ì¸
git branch

# ìƒíƒœ í™•ì¸
git status

# ìµœì‹  ì½”ë“œ ë°›ê¸°
git pull
```

**ì˜ˆìƒ ì¶œë ¥:**
```
Updating a1b2c3d..e4f5g6h
Fast-forward
 web/app/page.tsx          | 10 ++++---
 web/components/Header.tsx |  5 ++--
 2 files changed, 8 insertions(+), 7 deletions(-)
```

**ì¶©ëŒ ë°œìƒ ì‹œ:**
```bash
# âŒ ì„œë²„ì—ì„œ ì½”ë“œë¥¼ ìˆ˜ì •í•œ ê²½ìš° ì¶©ëŒ ë°œìƒ
# âœ… ê°œë°œìª½ì— ë³´ê³ :
"Git pull ì¶©ëŒ ë°œìƒ. ì„œë²„ì—ì„œ ìˆ˜ì •ëœ íŒŒì¼: [íŒŒì¼ëª…]"

# ì„ì‹œ í•´ê²° (ê°œë°œìª½ ìŠ¹ì¸ í›„):
git reset --hard origin/main
git pull
```

---

### 2ë‹¨ê³„: í™˜ê²½ë³€ìˆ˜ í™•ì¸

```bash
# .env.production íŒŒì¼ ì¡´ì¬ í™•ì¸
ls -la .env.production

# í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ í™•ì¸
cat .env.production | grep -v "PRIVATE_KEY" | grep -v "SECRET"
```

**.env.production ì˜ˆì‹œ:**
```env
NODE_ENV=production
ADMIN_GUARD_BYPASS=false
FIREBASE_ADMIN_CLIENT_EMAIL=firebase-adminsdk-xxxxx@blog-automation-23092.iam.gserviceaccount.com
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
```

**í™˜ê²½ë³€ìˆ˜ ìˆ˜ì • í•„ìš” ì‹œ:**
```bash
nano .env.production
# Ctrl+O, Enter, Ctrl+X
```

---

### 3ë‹¨ê³„: Docker ì´ë¯¸ì§€ ë¹Œë“œ

```bash
# ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì‚­ì œ
docker-compose down

# ì´ë¯¸ì§€ ì¬ë¹Œë“œ (ìºì‹œ ì—†ì´)
docker-compose build --no-cache
```

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 3-5ë¶„

**ë¹Œë“œ ê³¼ì •:**
```
Building web...
Building automation-server...
Step 1/15 : FROM node:18-alpine
Step 2/15 : WORKDIR /app
...
Successfully built xxxxx
Successfully tagged coupang_auto_blog_web:latest
Successfully tagged coupang_auto_blog_automation-server:latest
```

**ë¹Œë“œ ì‹¤íŒ¨ ì‹œ:**
```bash
# ì—ëŸ¬ ë¡œê·¸ ì €ì¥
docker-compose build 2>&1 | tee build.log

# ê°œë°œìª½ì— build.log ì „ë‹¬
cat build.log
```

---

### 4ë‹¨ê³„: ì„œë¹„ìŠ¤ ì‹¤í–‰

```bash
# ë°±ê·¸ë¼ìš´ë“œë¡œ ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d
```

**ì˜ˆìƒ ì¶œë ¥:**
```
Creating network "coupang_auto_blog_default" with the default driver
Creating coupang-blog ... done
Creating automation-server ... done
```

**ì»¨í…Œì´ë„ˆ í™•ì¸:**
```bash
docker ps
```

**ì˜ˆìƒ ì¶œë ¥:**
```
CONTAINER ID   IMAGE                              STATUS         PORTS
abc123         coupang_auto_blog_web              Up 10 seconds  0.0.0.0:3000->3000/tcp
def456         coupang_auto_blog_automation-server Up 10 seconds  0.0.0.0:5000->5000/tcp
```

---

### 5ë‹¨ê³„: ë°°í¬ í™•ì¸

#### 5-1. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
docker ps
docker-compose ps
```

#### 5-2. ë¡œê·¸ í™•ì¸

```bash
# ì „ì²´ ë¡œê·¸ (ì‹¤ì‹œê°„)
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs web
docker-compose logs automation-server

# ìµœê·¼ 100ì¤„
docker-compose logs --tail 100
```

**ì •ìƒ ì‹¤í–‰ ì˜ˆì‹œ:**
```
web_1  | > coupang-blog@0.1.0 start
web_1  | > next start
web_1  |
web_1  |   â–² Next.js 15.x.x
web_1  |   - Local:        http://localhost:3000
web_1  |
web_1  |  âœ“ Ready in 1234ms
```

#### 5-3. ì„œë¹„ìŠ¤ ì‘ë‹µ í™•ì¸

```bash
# ë¡œì»¬ ì ‘ì† í…ŒìŠ¤íŠ¸
curl -I http://127.0.0.1:3000

# HTTPS ì ‘ì† í…ŒìŠ¤íŠ¸
curl -I https://semolink.store
```

**ì˜ˆìƒ ì¶œë ¥:**
```
HTTP/2 200
server: nginx/1.18.0
content-type: text/html; charset=utf-8
...
```

---

## âœ… ë°°í¬ ì™„ë£Œ ë³´ê³ 

ëª¨ë“  ë‹¨ê³„ê°€ ì„±ê³µí•˜ë©´ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë³´ê³ :

```
âœ… ë°°í¬ ì™„ë£Œ!

- Git pull: ì„±ê³µ (3ê°œ íŒŒì¼ ì—…ë°ì´íŠ¸)
- ìµœì‹  ì»¤ë°‹: e4f5g6h - "fix: ë©”ì¸ í˜ì´ì§€ UI ê°œì„ "
- Docker build: ì„±ê³µ
- ì„œë¹„ìŠ¤ ì‹¤í–‰: ì •ìƒ
- https://semolink.store ì ‘ì†: ì •ìƒ

ì»¨í…Œì´ë„ˆ ìƒíƒœ:
- web: Up 2 minutes
- automation-server: Up 2 minutes

ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 250MB
```

---

## ğŸ”„ ì—…ë°ì´íŠ¸ ë°©ë²• (ë¹ ë¥¸ ì°¸ì¡°)

ì½”ë“œ ë³€ê²½ í›„ ì¬ë°°í¬:

```bash
cd /home/insuk/blog

# 1. ìµœì‹  ì½”ë“œ ë°›ê¸°
git pull

# 2. ì¬ë¹Œë“œ ë° ì¬ì‹œì‘
docker-compose down
docker-compose build --no-cache
docker-compose up -d

# 3. ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

**í•œ ì¤„ë¡œ ì‹¤í–‰:**
```bash
cd /home/insuk/blog && git pull && docker-compose down && docker-compose build --no-cache && docker-compose up -d
```

---

## ğŸ›‘ ì„œë¹„ìŠ¤ ì¤‘ì§€

```bash
cd /home/insuk/blog
docker-compose down
```

**ì»¨í…Œì´ë„ˆ ì‚­ì œê¹Œì§€:**
```bash
docker-compose down -v  # ë³¼ë¥¨ë„ ì‚­ì œ
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### Git Pull ì‹¤íŒ¨

**ì¦ìƒ:**
```
error: Your local changes to the following files would be overwritten by merge:
    web/app/page.tsx
```

**ì›ì¸:** ì„œë²„ì—ì„œ ì½”ë“œë¥¼ ìˆ˜ì •í•¨ (ê¸ˆì§€ëœ ì‘ì—…!)

**í•´ê²°:**
```bash
# 1. ìˆ˜ì •ëœ íŒŒì¼ í™•ì¸
git status

# 2. ê°œë°œìª½ì— ë³´ê³  í›„, ìŠ¹ì¸ ë°›ìœ¼ë©´:
git reset --hard origin/main
git pull
```

---

### ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•Šì„ ë•Œ

```bash
# 1. ë¡œê·¸ í™•ì¸
docker-compose logs

# 2. í™˜ê²½ë³€ìˆ˜ í™•ì¸
docker-compose config

# 3. íŠ¹ì • ì»¨í…Œì´ë„ˆ ë¡œê·¸
docker logs coupang-blog

# 4. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í™•ì¸
docker exec -it coupang-blog sh
env | grep NODE_ENV
```

---

### Nginx 502 Bad Gateway

```bash
# 1. Next.js ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps | grep coupang-blog
curl http://127.0.0.1:3000

# 2. Nginx ì„¤ì • í™•ì¸
sudo nginx -t

# 3. Nginx ì¬ì‹œì‘
sudo systemctl reload nginx

# 4. Nginx ë¡œê·¸
sudo tail -f /var/log/nginx/semolink-blog-error.log
```

---

### Docker Build ì‹¤íŒ¨

**ì¦ìƒ:**
```
ERROR [web 5/10] RUN npm ci
npm ERR! Cannot find module 'xxx'
```

**í•´ê²°:**
1. ì—ëŸ¬ ë¡œê·¸ ì €ì¥:
   ```bash
   docker-compose build 2>&1 | tee build.log
   ```
2. ê°œë°œìª½ì— build.log ì „ë‹¬
3. package.json ìˆ˜ì • í›„ ì¬ë°°í¬

---

### SSL ì¸ì¦ì„œ ë¬¸ì œ

```bash
# ì¸ì¦ì„œ í™•ì¸
sudo certbot certificates

# ì¸ì¦ì„œ ê°±ì‹ 
sudo certbot renew

# Nginx ì¬ì‹œì‘
sudo systemctl reload nginx
```

---

## ğŸ“ ì£¼ìš” ëª…ë ¹ì–´ ìš”ì•½

### Git ê´€ë ¨

```bash
# ìƒíƒœ í™•ì¸
git status

# ìµœì‹  ì½”ë“œ ë°›ê¸°
git fetch
git pull

# ì»¤ë°‹ íˆìŠ¤í† ë¦¬
git log --oneline -10

# íŠ¹ì • ì»¤ë°‹ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° (ê¸´ê¸‰ ë¡¤ë°±)
git reset --hard [ì»¤ë°‹ID]
git pull  # ê°•ì œë¡œ ìµœì‹  ìƒíƒœë¡œ
```

### Docker ê´€ë ¨

```bash
# ì»¨í…Œì´ë„ˆ ì‹œì‘
docker-compose up -d

# ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker-compose down

# ì¬ì‹œì‘ (ì½”ë“œ ë³€ê²½ ì—†ìŒ)
docker-compose restart

# ì¬ë¹Œë“œ
docker-compose build --no-cache

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ì‹œì‘
docker-compose restart web
```

### ëª¨ë‹ˆí„°ë§

```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h

# ë¡œê·¸ í™•ì¸
docker-compose logs --tail 100
```

---

## ğŸ” ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `.env.production`ì— ì‹¤ì œ Firebase Admin SDK í‚¤ ì„¤ì •
- [ ] `ADMIN_GUARD_BYPASS=false` ì„¤ì • (í”„ë¡œë•ì…˜)
- [ ] `NODE_ENV=production` ì„¤ì •
- [ ] SSL ì¸ì¦ì„œ ìë™ ê°±ì‹  í™•ì¸ (`certbot renew --dry-run`)
- [ ] ë°©í™”ë²½ ì„¤ì • (í¬íŠ¸ 80, 443ë§Œ ì—´ê¸°)
- [ ] Docker ì»¨í…Œì´ë„ˆê°€ 127.0.0.1:3000ì—ë§Œ ë°”ì¸ë”©ë˜ì—ˆëŠ”ì§€ í™•ì¸
- [ ] Gitì— `.env.production` ì»¤ë°‹ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸

---

## ğŸš¨ ê¸´ê¸‰ ë¡¤ë°± ì ˆì°¨

ë¬¸ì œ ë°œìƒ ì‹œ ì´ì „ ë²„ì „ìœ¼ë¡œ ë˜ëŒë¦¬ê¸°:

```bash
cd /home/insuk/blog

# 1. ì´ì „ ì»¤ë°‹ ID í™•ì¸
git log --oneline -10

# 2. ê°œë°œìª½ì—ì„œ ì§€ì •í•œ ì»¤ë°‹ìœ¼ë¡œ ë˜ëŒë¦¬ê¸°
git reset --hard [ì»¤ë°‹ID]

# 3. ì¬ë°°í¬
docker-compose down
docker-compose build --no-cache
docker-compose up -d

# 4. í™•ì¸
curl -I https://semolink.store
```

**ì˜ˆì‹œ:**
```bash
# ì»¤ë°‹ 06ae06cë¡œ ë¡¤ë°±
git reset --hard 06ae06c
docker-compose down && docker-compose up -d --build
```

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

### ìµœì´ˆ ë°°í¬ ì‹œ

1. âœ… ì„œë²„ì— Git ì €ì¥ì†Œ ì„¤ì •
2. âœ… `.env.production` íŒŒì¼ ìƒì„± ë° í™˜ê²½ë³€ìˆ˜ ì„¤ì •
3. âœ… ì²« ë°°í¬: `git pull && docker-compose up -d --build`
4. âœ… Nginx ì„¤ì •
5. âœ… SSL ì¸ì¦ì„œ ì„¤ì •
6. âœ… https://semolink.store ì ‘ì† í™•ì¸

### ì¼ë°˜ ì—…ë°ì´íŠ¸ ì‹œ

1. âœ… ê°œë°œìª½ì—ì„œ "Git push ì™„ë£Œ" í†µë³´ ë°›ìŒ
2. âœ… `git pull` ì‹¤í–‰
3. âœ… `docker-compose down && docker-compose build --no-cache && docker-compose up -d` ì‹¤í–‰
4. âœ… ë°°í¬ í™•ì¸
5. âœ… ê²°ê³¼ ë³´ê³ 

---

## ğŸ“– ê´€ë ¨ ë¬¸ì„œ

- `CLAUDE.md` - Claude ì‘ì—… ì§€ì¹¨ (ì „ì²´ ì›Œí¬í”Œë¡œìš°)
- `docs/ì„œë²„-ìš´ì˜-ì§€ì¹¨.md` - ì„œë²„ ìš´ì˜ ìƒì„¸ ê°€ì´ë“œ
- `docs/ì„œë²„-Claude-ì²´í¬ë¦¬ìŠ¤íŠ¸.md` - ì„œë²„ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
- `docs/ê°œë°œ-ë°°í¬-ê°€ì´ë“œ.md` - ê°œë°œ ì»´í“¨í„° ê°€ì´ë“œ
- `README.md` - í”„ë¡œì íŠ¸ ê°œìš”

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:** 2026-02-10 (Git ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°ë¡œ ì „í™˜)
